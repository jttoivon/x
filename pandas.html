

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pandas &mdash; Data analysis with Python  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Data analysis with Python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="instructions.html">Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy.html">Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="matplotlib.html">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_processing.html">Image processing</a></li>
</ul>
<p class="caption"><span class="caption-text">Machine learning:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="linear_regression.html">Linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="bayes.html">Naive Bayes classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="pca.html">Principal component analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Data analysis with Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Pandas</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pandas.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<!--NAVIGATION--><div class="section" id="Pandas">
<h1>Pandas<a class="headerlink" href="#Pandas" title="Permalink to this headline">¶</a></h1>
<p>In the NumPy section we dealt with some arrays, whose columns had each a
special meaning. For example, the column number 0 could contains values
interpreted as years, and column 1 could contain a month, and so on. It
is possible to handle the data this way, but in can be hard to remember,
which column number corresponds to which variable. Especially, if you
later remove some column from the array, then the numbering of the
remaining columns changes. One solution to this is to give a descriptive
name to each column. These column names stay fixed and attached to their
corresponding columns, even if we remove some of the columns. In
addition, the rows can be given names as well, these are called
<em>indices</em> in Pandas.</p>
<p>The <em>Pandas</em> library is build on top of the NumPy library, and it
provides a special kind of two dimensional data structure called
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. The <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> allows to give names to the columns, so
that one can access a column using its name inplace of the index of the
column.</p>
<p>The quickly go through few examples to see what is possible with Pandas.
It is typical to import the Pandas library as the shorthand <code class="docutils literal notranslate"><span class="pre">pd</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>    <span class="c1"># This is the standard way of importing the Pandas library</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://www.cs.helsinki.fi/u/jttoivon/dap/data/fmi/kumpula-weather-2017.csv&quot;</span><span class="p">)</span>
<span class="n">wh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>   <span class="c1"># The head method prints the first 5 rows</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now we can refer to a column by its name:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Snow depth (cm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>     <span class="c1"># Using the tab key can help enter long column names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    -1.0
1    -1.0
2     7.0
3    13.0
4    10.0
Name: Snow depth (cm), dtype: float64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Air temperature (degC)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>    <span class="c1"># Mean temperature</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>6.527123287671233
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Time zone&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>    <span class="c1"># Return a copy with one column removed, the original DataFrame stays intact</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We will now go through systematically through the DataFrame and its
one-dimensional version: <em>Series</em>.</p>
<div class="section" id="Creation-and-indexing-of-series">
<h2>Creation and indexing of series<a class="headerlink" href="#Creation-and-indexing-of-series" title="Permalink to this headline">¶</a></h2>
<p>One can turn any one-dimensional iterable into a Series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [99]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[99]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1
1    4
2    5
3    2
4    5
5    2
dtype: int64
</pre></div>
</div>
</div>
<p>The data type of the elements in the Series is <code class="docutils literal notranslate"><span class="pre">int64</span></code>, integers
representable in 64 bits.</p>
<p>We can also attach a name to this series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Grades&quot;</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[82]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1
1    4
2    2
3    2
4    5
Name: Grades, dtype: int64
</pre></div>
</div>
</div>
<p>The common attributes of the series are the <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, and
<code class="docutils literal notranslate"><span class="pre">size</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name: </span><span class="si">%s</span><span class="s2">, dtype: </span><span class="si">%s</span><span class="s2">, size: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Name: Grades, dtype: int64, size: 5
</pre></div></div>
</div>
<p>In addition to the values of the series, also the row indices were
printed. All the accessing methods from NumPy arrays also work for the
Series: indexing, slicing, and fancy indexing.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[100]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>4
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [110]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s2</span><span class="o">=</span><span class="n">s</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>                    <span class="c1"># Fancy indexing</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [111]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">t</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>                    <span class="c1"># Slicing</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[111]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>4    5
5    2
dtype: int64
</pre></div>
</div>
</div>
<p>Note that the indices stick to the corresponding values, they are not
renumbered!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>                        <span class="c1"># t[0] would give an error</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[112]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>5
</pre></div>
</div>
</div>
<p>The values as a NumPy array are accessible with the <code class="docutils literal notranslate"><span class="pre">values</span></code>
attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [113]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s2</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[113]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([1, 2])
</pre></div>
</div>
</div>
<p>And the indices are available through the <code class="docutils literal notranslate"><span class="pre">index</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [114]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s2</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[114]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Int64Index([0, 5], dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
<p>The index is not simply a NumPy array, but a data structure that allows
fast access to the elements. The indices need not be integers, as the
next example shows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abcdef&quot;</span><span class="p">))</span>
<span class="n">s3</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[116]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>a    1
b    4
c    5
d    2
e    5
f    2
dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [117]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[117]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [119]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[119]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>4
</pre></div>
</div>
</div>
<div class="admonition warning">
Note a special case here: if the indices are not integers, then the last
index of the slice is included in the result. This is contrary to
slicing with integers!</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [127]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="s2">&quot;e&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[127]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>b    4
c    5
d    2
e    5
dtype: int64
</pre></div>
</div>
</div>
<p>If one really must, then one can also access the Series through the
<em>implicit integers index</em>. This indexing works exactly like in NumPy.
The <code class="docutils literal notranslate"><span class="pre">iloc</span></code> attribute allows accessing using integers:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [125]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0 1
1 4
2 5
3 2
4 5
5 2
</pre></div></div>
</div>
<p>One may notice that there are similarities between Python’s dictionaries
and Pandas’ Series, both can be thought to access values using keys. The
difference is that Series requires that the indices have all the same
type, and similarly, all the values have the same type. This restriction
allows creation of fast data structures.</p>
<p>As a mark of the similaries between these two data structures, Pandas
allows creation of a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object from a dictionary:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [131]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">2001</span> <span class="p">:</span> <span class="s2">&quot;Bush&quot;</span><span class="p">,</span> <span class="mi">2005</span><span class="p">:</span> <span class="s2">&quot;Bush&quot;</span><span class="p">,</span> <span class="mi">2009</span><span class="p">:</span> <span class="s2">&quot;Obama&quot;</span><span class="p">,</span> <span class="mi">2013</span><span class="p">:</span> <span class="s2">&quot;Obama&quot;</span><span class="p">,</span> <span class="mi">2017</span> <span class="p">:</span> <span class="s2">&quot;Trump&quot;</span><span class="p">}</span>
<span class="n">s4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Presidents&quot;</span><span class="p">)</span>
<span class="n">s4</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[131]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>2001     Bush
2005     Bush
2009    Obama
2013    Obama
2017    Trump
Name: Presidents, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="section" id="Creation-of-dataframes">
<h2>Creation of dataframes<a class="headerlink" href="#Creation-of-dataframes" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Accessing-columns-of-a-dataframe.-Results-in">
<h2>Accessing columns of a dataframe. Results in<a class="headerlink" href="#Accessing-columns-of-a-dataframe.-Results-in" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>a series</li>
<li>a dataframe with n columns (n=0,1,2,…)</li>
</ul>
</div>
<div class="section" id="Other-indexing-and-data-selection">
<h2>Other indexing and data selection<a class="headerlink" href="#Other-indexing-and-data-selection" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Summary-statistics">
<h2>Summary statistics<a class="headerlink" href="#Summary-statistics" title="Permalink to this headline">¶</a></h2>
<p>The summary statistic methods work in a similar way as their counter
parts in NumPy. By default, the aggregation is done over columns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># taking averages over these is not very interesting</span>
<span class="n">wh2</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[19]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Precipitation amount (mm)    1.966301
Snow depth (cm)              0.966480
Air temperature (degC)       6.527123
dtype: float64
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">describe</span></code> method of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object gives different
summary statistics for each (numeric) column. The result is a DataFrame.
This method gives a good overview of the data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>365.0</td>
      <td>365.000000</td>
      <td>365.000000</td>
      <td>365.000000</td>
      <td>358.000000</td>
      <td>365.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2017.0</td>
      <td>6.526027</td>
      <td>15.720548</td>
      <td>1.966301</td>
      <td>0.966480</td>
      <td>6.527123</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.0</td>
      <td>3.452584</td>
      <td>8.808321</td>
      <td>4.858423</td>
      <td>3.717472</td>
      <td>7.183934</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2017.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-17.800000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2017.0</td>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>1.200000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2017.0</td>
      <td>7.000000</td>
      <td>16.000000</td>
      <td>0.200000</td>
      <td>-1.000000</td>
      <td>4.800000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2017.0</td>
      <td>10.000000</td>
      <td>23.000000</td>
      <td>2.700000</td>
      <td>0.000000</td>
      <td>12.900000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2017.0</td>
      <td>12.000000</td>
      <td>31.000000</td>
      <td>35.000000</td>
      <td>15.000000</td>
      <td>19.600000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>WHY IS COUNT OF SNOW ONLY 358?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="n">wh</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>74</th>
      <td>2017</td>
      <td>3</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.8</td>
      <td>NaN</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>163</th>
      <td>2017</td>
      <td>6</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>NaN</td>
      <td>12.6</td>
    </tr>
    <tr>
      <th>308</th>
      <td>2017</td>
      <td>11</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>NaN</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>309</th>
      <td>2017</td>
      <td>11</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>313</th>
      <td>2017</td>
      <td>11</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.6</td>
      <td>NaN</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>321</th>
      <td>2017</td>
      <td>11</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>11.3</td>
      <td>NaN</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>328</th>
      <td>2017</td>
      <td>11</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.5</td>
      <td>NaN</td>
      <td>4.2</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Missing-data">
<h2>Missing data<a class="headerlink" href="#Missing-data" title="Permalink to this headline">¶</a></h2>
<p>You may have noticed something strange in the output of the describe
method: the snow depth column has count 358, whereas the other columns
have count 365, one measurement/value for each day of the year. How is
this possible? Let’s use the <code class="docutils literal notranslate"><span class="pre">unique</span></code> method of the Series object to
find out, which different values are used in this column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Snow depth (cm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([-1.,  7., 13., 10., 12.,  9.,  8.,  5.,  6.,  4.,  3., 15., 14.,
        2., nan,  0.])
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">float</span></code> type allows a special value <code class="docutils literal notranslate"><span class="pre">nan</span></code> (Not A Number), in
addition to normal floating point numbers. This value can represent the
result from an illegal operation. For example, the operation 0/0 can
either cause an exception to occur or just silently produce a <code class="docutils literal notranslate"><span class="pre">nan</span></code>.
In Pandas <code class="docutils literal notranslate"><span class="pre">nan</span></code> can be used to represent a missing value. In the
weather DataFrame the <code class="docutils literal notranslate"><span class="pre">nan</span></code> value tells us that the measurement from
that day is not available, possibly due to a broken measuring instrument
or some other problem.</p>
<p>Note that only float types allow the <code class="docutils literal notranslate"><span class="pre">nan</span></code> value. So, if we try to
create an integer series with missing values, its dtype gets promoted to
<code class="docutils literal notranslate"><span class="pre">float</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[23]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1
1    3
2    2
dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[26]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1.0
1    3.0
2    2.0
3    NaN
dtype: float64
</pre></div>
</div>
</div>
<p>For non-numeric types the special value <code class="docutils literal notranslate"><span class="pre">None</span></code> is used to denote the
missing value, and the dtype is promoted to <code class="docutils literal notranslate"><span class="pre">object</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;jack&quot;</span><span class="p">,</span> <span class="s2">&quot;joe&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    jack
1     joe
2    None
dtype: object
</pre></div>
</div>
</div>
<p>Pandas excludes the missing values from the summary statistics, like we
saw in the previous section. Pandas also provides some functions to
handle missing values.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dropna</span></code> method of a DataFrame drops columns or rows that contain
missing values from the DataFrame, depending on the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>   <span class="c1"># Default axis is 0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(358, 8)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># Drops the columns containing missing values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[31]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(365, 7)
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">how</span></code> and <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameters of the <code class="docutils literal notranslate"><span class="pre">dropna</span></code> method allow one
to specify how many values need to be missing in order the row/column to
be dropped.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>304</th>
      <td>2017</td>
      <td>11</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>305</th>
      <td>2017</td>
      <td>11</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>306</th>
      <td>2017</td>
      <td>11</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>-1.0</td>
      <td>3.2</td>
    </tr>
    <tr>
      <th>307</th>
      <td>2017</td>
      <td>11</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.0</td>
      <td>-1.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>308</th>
      <td>2017</td>
      <td>11</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>NaN</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>309</th>
      <td>2017</td>
      <td>11</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>310</th>
      <td>2017</td>
      <td>11</td>
      <td>7</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>311</th>
      <td>2017</td>
      <td>11</td>
      <td>8</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>-1.0</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>312</th>
      <td>2017</td>
      <td>11</td>
      <td>9</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>9.3</td>
      <td>-1.0</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>313</th>
      <td>2017</td>
      <td>11</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.6</td>
      <td>NaN</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>314</th>
      <td>2017</td>
      <td>11</td>
      <td>11</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>16.7</td>
      <td>-1.0</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>315</th>
      <td>2017</td>
      <td>11</td>
      <td>12</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.2</td>
      <td>-1.0</td>
      <td>3.1</td>
    </tr>
    <tr>
      <th>316</th>
      <td>2017</td>
      <td>11</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>317</th>
      <td>2017</td>
      <td>11</td>
      <td>14</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.1</td>
      <td>-1.0</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>318</th>
      <td>2017</td>
      <td>11</td>
      <td>15</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.1</td>
      <td>-1.0</td>
      <td>3.1</td>
    </tr>
    <tr>
      <th>319</th>
      <td>2017</td>
      <td>11</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.8</td>
      <td>-1.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>320</th>
      <td>2017</td>
      <td>11</td>
      <td>17</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.0</td>
      <td>-1.0</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>321</th>
      <td>2017</td>
      <td>11</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>11.3</td>
      <td>NaN</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>322</th>
      <td>2017</td>
      <td>11</td>
      <td>19</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>10.4</td>
      <td>-1.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>323</th>
      <td>2017</td>
      <td>11</td>
      <td>20</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.5</td>
      <td>-1.0</td>
      <td>1.2</td>
    </tr>
    <tr>
      <th>324</th>
      <td>2017</td>
      <td>11</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>325</th>
      <td>2017</td>
      <td>11</td>
      <td>22</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.5</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>326</th>
      <td>2017</td>
      <td>11</td>
      <td>23</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.2</td>
      <td>-1.0</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>327</th>
      <td>2017</td>
      <td>11</td>
      <td>24</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>9.0</td>
      <td>-1.0</td>
      <td>6.1</td>
    </tr>
    <tr>
      <th>328</th>
      <td>2017</td>
      <td>11</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.5</td>
      <td>NaN</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>329</th>
      <td>2017</td>
      <td>11</td>
      <td>26</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.5</td>
      <td>-1.0</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>330</th>
      <td>2017</td>
      <td>11</td>
      <td>27</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.7</td>
      <td>-1.0</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>331</th>
      <td>2017</td>
      <td>11</td>
      <td>28</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.3</td>
      <td>-1.0</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>332</th>
      <td>2017</td>
      <td>11</td>
      <td>29</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.1</td>
      <td>-1.0</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>333</th>
      <td>2017</td>
      <td>11</td>
      <td>30</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.1</td>
      <td>-1.0</td>
      <td>3.1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Precipitation amount (mm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([-1. ,  0.1,  0.2,  0.3,  0.4,  0.5,  0.6,  0.7,  0.8,  0.9,  1. ,
        1.1,  1.2,  1.3,  1.4,  1.5,  1.6,  1.7,  1.8,  1.9,  2. ,  2.1,
        2.2,  2.4,  2.5,  2.6,  2.7,  2.8,  2.9,  3.1,  3.2,  3.3,  3.4,
        3.5,  3.6,  3.7,  3.9,  4.1,  4.2,  4.3,  4.4,  4.5,  4.6,  4.7,
        4.9,  5. ,  5.1,  5.2,  5.3,  5.4,  5.5,  5.6,  5.7,  5.9,  6. ,
        6.1,  6.2,  6.4,  6.6,  6.9,  7.2,  7.6,  7.7,  7.8,  8. ,  8.3,
        8.5,  9. ,  9.3,  9.4,  9.9, 10. , 10.3, 10.4, 11. , 11.3, 11.7,
       12.2, 12.3, 12.7, 14.1, 15.4, 15.9, 16.3, 16.4, 16.7, 17.1, 18.1,
       18.3, 18.6, 19.6, 21.5, 24.2, 26.5, 35. ])
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Precipitation amount (mm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Snow depth (cm)&quot;</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2017</td>
      <td>1</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2017</td>
      <td>1</td>
      <td>7</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.3</td>
      <td>10.0</td>
      <td>-3.8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2017</td>
      <td>1</td>
      <td>8</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>12.0</td>
      <td>-0.5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2017</td>
      <td>1</td>
      <td>9</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.1</td>
      <td>12.0</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2017</td>
      <td>1</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>9.0</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2017</td>
      <td>1</td>
      <td>11</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>7.0</td>
      <td>-1.6</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2017</td>
      <td>1</td>
      <td>12</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>-2.8</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2017</td>
      <td>1</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>13.0</td>
      <td>1.1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2017</td>
      <td>1</td>
      <td>14</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>8.0</td>
      <td>0.8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2017</td>
      <td>1</td>
      <td>15</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-2.8</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2017</td>
      <td>1</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-4.2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2017</td>
      <td>1</td>
      <td>17</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>8.0</td>
      <td>-3.5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2017</td>
      <td>1</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.9</td>
      <td>8.0</td>
      <td>1.1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2017</td>
      <td>1</td>
      <td>19</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>5.0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2017</td>
      <td>1</td>
      <td>20</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>5.0</td>
      <td>-0.6</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2017</td>
      <td>1</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.4</td>
      <td>5.0</td>
      <td>-1.8</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2017</td>
      <td>1</td>
      <td>22</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2017</td>
      <td>1</td>
      <td>23</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>6.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2017</td>
      <td>1</td>
      <td>24</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>6.0</td>
      <td>-2.2</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2017</td>
      <td>1</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>6.0</td>
      <td>-3.8</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2017</td>
      <td>1</td>
      <td>26</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>6.0</td>
      <td>1.9</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2017</td>
      <td>1</td>
      <td>27</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>4.0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2017</td>
      <td>1</td>
      <td>28</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.8</td>
      <td>4.0</td>
      <td>0.8</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2017</td>
      <td>1</td>
      <td>29</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.6</td>
      <td>3.0</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2017</td>
      <td>1</td>
      <td>30</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.6</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2017</td>
      <td>1</td>
      <td>31</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>4.0</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2017</td>
      <td>2</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.5</td>
      <td>4.0</td>
      <td>-0.6</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>74</th>
      <td>2017</td>
      <td>3</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.8</td>
      <td>NaN</td>
      <td>3.4</td>
    </tr>
    <tr>
      <th>79</th>
      <td>2017</td>
      <td>3</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>89</th>
      <td>2017</td>
      <td>3</td>
      <td>31</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>2.0</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>102</th>
      <td>2017</td>
      <td>4</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>0.0</td>
      <td>1.2</td>
    </tr>
    <tr>
      <th>114</th>
      <td>2017</td>
      <td>4</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.9</td>
      <td>0.0</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>119</th>
      <td>2017</td>
      <td>4</td>
      <td>30</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.4</td>
      <td>2.0</td>
      <td>2.2</td>
    </tr>
    <tr>
      <th>163</th>
      <td>2017</td>
      <td>6</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>NaN</td>
      <td>12.6</td>
    </tr>
    <tr>
      <th>293</th>
      <td>2017</td>
      <td>10</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>296</th>
      <td>2017</td>
      <td>10</td>
      <td>24</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.8</td>
    </tr>
    <tr>
      <th>298</th>
      <td>2017</td>
      <td>10</td>
      <td>26</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>12.3</td>
      <td>2.0</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>299</th>
      <td>2017</td>
      <td>10</td>
      <td>27</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.7</td>
      <td>7.0</td>
      <td>-0.3</td>
    </tr>
    <tr>
      <th>300</th>
      <td>2017</td>
      <td>10</td>
      <td>28</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>17.1</td>
      <td>4.0</td>
      <td>3.3</td>
    </tr>
    <tr>
      <th>304</th>
      <td>2017</td>
      <td>11</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>305</th>
      <td>2017</td>
      <td>11</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>308</th>
      <td>2017</td>
      <td>11</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>NaN</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>309</th>
      <td>2017</td>
      <td>11</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>313</th>
      <td>2017</td>
      <td>11</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.6</td>
      <td>NaN</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>321</th>
      <td>2017</td>
      <td>11</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>11.3</td>
      <td>NaN</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>324</th>
      <td>2017</td>
      <td>11</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.5</td>
      <td>3.0</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>328</th>
      <td>2017</td>
      <td>11</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.5</td>
      <td>NaN</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>335</th>
      <td>2017</td>
      <td>12</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.3</td>
      <td>5.0</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>340</th>
      <td>2017</td>
      <td>12</td>
      <td>7</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>16.3</td>
      <td>0.0</td>
      <td>-0.8</td>
    </tr>
    <tr>
      <th>346</th>
      <td>2017</td>
      <td>12</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.2</td>
      <td>5.0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>347</th>
      <td>2017</td>
      <td>12</td>
      <td>14</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.2</td>
      <td>4.0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>348</th>
      <td>2017</td>
      <td>12</td>
      <td>15</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>349</th>
      <td>2017</td>
      <td>12</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.3</td>
      <td>6.0</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>350</th>
      <td>2017</td>
      <td>12</td>
      <td>17</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>5.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>351</th>
      <td>2017</td>
      <td>12</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.5</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>352</th>
      <td>2017</td>
      <td>12</td>
      <td>19</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>353</th>
      <td>2017</td>
      <td>12</td>
      <td>20</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.6</td>
      <td>3.0</td>
      <td>2.6</td>
    </tr>
  </tbody>
</table>
<p>102 rows × 8 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Catenating-datasets">
<h2>Catenating datasets<a class="headerlink" href="#Catenating-datasets" title="Permalink to this headline">¶</a></h2>
<p>We already saw in the NumPy section how we can catenate arrays along an
axis: axis=0 catenates vertically and axis=1 catenates horizontally, and
so on. With the DataFrames of Pandas it works similarly except that the
row indices and the column names require extra attention. Also note a
slight difference in the name: <code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code> but <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code>.</p>
<p>Let’s start by considering catenation along the axis 0, that is,
vertical catenation. We will first make a helper function to easily
create DataFrames for testing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">makedf</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span> <span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next we will create some example DataFrames:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;AB&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">b</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;AB&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;CD&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[64]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
      <td>C3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the following simple case, the <code class="docutils literal notranslate"><span class="pre">concat</span></code> function works exactly as
we expect it would:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">])</span>   <span class="c1"># The default axis is 0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The next, however, will create duplicate indices:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[56]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    A0
0    A0
Name: A, dtype: object
</pre></div>
</div>
</div>
<p>This is not usually what we want! There are three solutions to this.
Firstly, deny creation of duplicated indices by giving the
<code class="docutils literal notranslate"><span class="pre">verify_integrity</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">concat</span></code> function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-57-82fa67db54bb&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>pd<span class="ansi-blue-fg">.</span>concat<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>a<span class="ansi-blue-fg">,</span>a<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> verify_integrity<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.6/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">concat</span><span class="ansi-blue-fg">(objs, axis, join, join_axes, ignore_index, keys, levels, names, verify_integrity, sort, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">    223</span>                        keys<span class="ansi-blue-fg">=</span>keys<span class="ansi-blue-fg">,</span> levels<span class="ansi-blue-fg">=</span>levels<span class="ansi-blue-fg">,</span> names<span class="ansi-blue-fg">=</span>names<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    224</span>                        verify_integrity<span class="ansi-blue-fg">=</span>verify_integrity<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 225</span><span class="ansi-red-fg">                        copy=copy, sort=sort)
</span><span class="ansi-green-intense-fg ansi-bold">    226</span>     <span class="ansi-green-fg">return</span> op<span class="ansi-blue-fg">.</span>get_result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    227</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.6/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, objs, axis, join, join_axes, keys, levels, names, ignore_index, verify_integrity, copy, sort)</span>
<span class="ansi-green-intense-fg ansi-bold">    376</span>         self<span class="ansi-blue-fg">.</span>copy <span class="ansi-blue-fg">=</span> copy
<span class="ansi-green-intense-fg ansi-bold">    377</span>
<span class="ansi-green-fg">--&gt; 378</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>new_axes <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_get_new_axes<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    379</span>
<span class="ansi-green-intense-fg ansi-bold">    380</span>     <span class="ansi-green-fg">def</span> get_result<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.6/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">_get_new_axes</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    456</span>                 new_axes<span class="ansi-blue-fg">[</span>i<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> ax
<span class="ansi-green-intense-fg ansi-bold">    457</span>
<span class="ansi-green-fg">--&gt; 458</span><span class="ansi-red-fg">         </span>new_axes<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>axis<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_get_concat_axis<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    459</span>         <span class="ansi-green-fg">return</span> new_axes
<span class="ansi-green-intense-fg ansi-bold">    460</span>

<span class="ansi-green-fg">~/anaconda3/lib/python3.6/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">_get_concat_axis</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    514</span>                                                   self.levels, self.names)
<span class="ansi-green-intense-fg ansi-bold">    515</span>
<span class="ansi-green-fg">--&gt; 516</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_maybe_check_integrity<span class="ansi-blue-fg">(</span>concat_axis<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    517</span>
<span class="ansi-green-intense-fg ansi-bold">    518</span>         <span class="ansi-green-fg">return</span> concat_axis

<span class="ansi-green-fg">~/anaconda3/lib/python3.6/site-packages/pandas/core/reshape/concat.py</span> in <span class="ansi-cyan-fg">_maybe_check_integrity</span><span class="ansi-blue-fg">(self, concat_index)</span>
<span class="ansi-green-intense-fg ansi-bold">    523</span>                 overlap <span class="ansi-blue-fg">=</span> concat_index<span class="ansi-blue-fg">[</span>concat_index<span class="ansi-blue-fg">.</span>duplicated<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>unique<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    524</span>                 raise ValueError(&#39;Indexes have overlapping values: &#39;
<span class="ansi-green-fg">--&gt; 525</span><span class="ansi-red-fg">                                  &#39;{overlap!s}&#39;.format(overlap=overlap))
</span><span class="ansi-green-intense-fg ansi-bold">    526</span>
<span class="ansi-green-intense-fg ansi-bold">    527</span>

<span class="ansi-red-fg">ValueError</span>: Indexes have overlapping values: Int64Index([0, 1], dtype=&#39;int64&#39;)
</pre></div></div>
</div>
<p>Secondly, we can ask for automatic renumbering of rows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Thirdly, we can ask for <em>hierarchical indexing</em>. More about hierarchical
indexing in section XXX.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">])</span>
<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[60]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">first</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">second</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r2</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">][</span><span class="s2">&quot;first&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[63]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;A0&#39;
</pre></div>
</div>
</div>
<p>Everything works similarly, when we want to catenate horizontally:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[65]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We have so far assumed that when concatenating vertically the column of
both DataFrames are the same, and when joining horizontally the indices
are the same. This is, however, not required:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/home/jttoivon/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:1: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass &#39;sort=True&#39;.

To retain the current behavior and silence the warning, pass sort=False

  &#34;&#34;&#34;Entry point for launching an IPython kernel.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[66]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>B3</td>
      <td>C3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>It expanded the non-existing cases with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s. This method is
called an <em>outer join</em>, which forms the union of columns in the two
DataFrames. The alternative is <em>inner join</em>, which forms the
intersection of columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">],</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[67]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Merging-dataframes">
<h2>Merging dataframes<a class="headerlink" href="#Merging-dataframes" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Aggregates-and-groupings">
<h2>Aggregates and groupings<a class="headerlink" href="#Aggregates-and-groupings" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Time-series">
<h2>Time series<a class="headerlink" href="#Time-series" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/pandas-dev/pandas/blob/master/doc/cheatsheet/Pandas_Cheat_Sheet.pdf">Pandas cheat
sheet</a></p>
<!--NAVIGATION--></div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Jarkko Toivonen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>