

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pandas &mdash; Data analysis with Python  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linear regression" href="linear_regression.html" />
    <link rel="prev" title="Image processing" href="image_processing.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Data analysis with Python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="instructions.html">Instructions</a></li>
</ul>
<p class="caption"><span class="caption-text">Week 1:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Python</a></li>
</ul>
<p class="caption"><span class="caption-text">Week 2:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basics2.html">Python (continues)</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy.html">Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="matplotlib.html">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_processing.html">Image processing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Creation-and-indexing-of-series">Creation and indexing of series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Onko-seuraava-pätkä-tarpeen?">Onko seuraava pätkä tarpeen?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Creation-of-dataframes">Creation of dataframes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Creating-DataFrames-from-a-NumPy-array">Creating DataFrames from a NumPy array</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-DataFrames-from-columns">Creating DataFrames from columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-DataFrames-from-rows">Creating DataFrames from rows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Accessing-columns-and-rows-of-a-dataframe">Accessing columns and rows of a dataframe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Alternative-indexing-and-data-selection">Alternative indexing and data selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Summary-statistics">Summary statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Missing-data">Missing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#String-processing">String processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Catenating-datasets">Catenating datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Merging-dataframes">Merging dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Aggregates-and-groupings">Aggregates and groupings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Other-ways-to-operate-on-groups">Other ways to operate on groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Time-series">Time series</a></li>
<li class="toctree-l2"><a class="reference internal" href="#External-information">External information</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Machine learning:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="linear_regression.html">Linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="bayes.html">Naive Bayes classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="pca.html">Principal component analysis</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Data analysis with Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Pandas</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pandas.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
This page was generated from <a class="reference external" href="https://github.com/jttoivon/x/blob/master/pandas.ipynb">pandas.ipynb</a>.
<span class="raw-html"><br/><a href='https://colab.research.google.com/github/jttoivon/x/blob/master/pandas.ipynb'><img align='left' src='https://colab.research.google.com/assets/colab-badge.svg' alt='Open in Colab' title='Open and Execute in Google Colaboratory' /></a></span>
<span class="raw-html"><br/></span></div>
<!--NAVIGATION--><div class="section" id="Pandas">
<h1>Pandas<a class="headerlink" href="#Pandas" title="Permalink to this headline">¶</a></h1>
<p>In the NumPy section we dealt with some arrays, whose columns had each a special meaning. For example, the column number 0 could contain values interpreted as years, and column 1 could contain a month, and so on. It is possible to handle the data this way, but in can be hard to remember, which column number corresponds to which variable. Especially, if you later remove some column from the array, then the numbering of the remaining columns changes. One solution to this is to give a descriptive
name to each column. These column names stay fixed and attached to their corresponding columns, even if we remove some of the columns. In addition, the rows can be given names as well, these are called <em>indices</em> in Pandas.</p>
<p>The <em>Pandas</em> library is build on top of the NumPy library, and it provides a special kind of two dimensional data structure called <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. The <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> allows to give names to the columns, so that one can access a column using its name in place of the index of the column.</p>
<p>First we will quickly go through few examples to see what is possible with Pandas. We start by doing some standard imports:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>    <span class="c1"># This is the standard way of importing the Pandas library</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<p>Let’s import some weather data that is in text from in a csv (Commma Separated Values) file. The following call will fetch the data from the internet and convert it to a DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://www.cs.helsinki.fi/u/jttoivon/dap/data/fmi/kumpula-weather-2017.csv&quot;</span><span class="p">)</span>
<span class="n">wh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>   <span class="c1"># The head method prints the first 5 rows</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We see that the DataFrame contains eight columns, three of which are actual measured variables. Now we can refer to a column by its name:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Snow depth (cm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>     <span class="c1"># Using the tab key can help enter long column names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    -1.0
1    -1.0
2     7.0
3    13.0
4    10.0
Name: Snow depth (cm), dtype: float64
</pre></div>
</div>
</div>
<p>There are several summary statistic methods that operate on a column or on all the columns. The next example computes the mean of the temperatures over all rows of the DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Air temperature (degC)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>    <span class="c1"># Mean temperature</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>6.527123287671233
</pre></div>
</div>
</div>
<p>We can drop some columns from the DataFrame with the <code class="docutils literal notranslate"><span class="pre">drop</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Time zone&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>    <span class="c1"># Return a copy with one column removed, the original DataFrame stays intact</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>     <span class="c1"># Original DataFrame is unchanged</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In case you want to modify the original DataFrame, you can either assign the result to the original DataFrame, or use the <code class="docutils literal notranslate"><span class="pre">inplace</span></code> parameter of the <code class="docutils literal notranslate"><span class="pre">drop</span></code> method.</p>
<p>Addition of a new column works like adding a new key-value pair to a dictionary:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Rainy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Precipitation amount (mm)&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span>
<span class="n">wh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the next section we will systematically go through the DataFrame and its one-dimensional version: <em>Series</em>.</p>
<div class="section" id="Creation-and-indexing-of-series">
<h2>Creation and indexing of series<a class="headerlink" href="#Creation-and-indexing-of-series" title="Permalink to this headline">¶</a></h2>
<p>One can turn any one-dimensional iterable into a Series, which is a one-dimensional data structure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1
1    4
2    5
3    2
4    5
5    2
dtype: int64
</pre></div>
</div>
</div>
<p>The data type of the elements in the Series is <code class="docutils literal notranslate"><span class="pre">int64</span></code>, integers representable in 64 bits.</p>
<p>We can also attach a name to this series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Grades&quot;</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1
1    4
2    5
3    2
4    5
5    2
Name: Grades, dtype: int64
</pre></div>
</div>
</div>
<p>The common attributes of the series are the <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, and <code class="docutils literal notranslate"><span class="pre">size</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name: </span><span class="si">%s</span><span class="s2">, dtype: </span><span class="si">%s</span><span class="s2">, size: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Name: Grades, dtype: int64, size: 6
</pre></div></div>
</div>
<p>In addition to the values of the series, also the row indices were printed. All the accessing methods from NumPy arrays also work for the Series: indexing, slicing, and fancy indexing.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>4
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s2</span><span class="o">=</span><span class="n">s</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>                    <span class="c1"># Fancy indexing</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">t</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>                    <span class="c1"># Slicing</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>4    5
5    2
Name: Grades, dtype: int64
</pre></div>
</div>
</div>
<p>Note that the indices stick to the corresponding values, they are not renumbered!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">t</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>                        <span class="c1"># t[0] would give an error</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>5
</pre></div>
</div>
</div>
<p>The values as a NumPy array are accessible via the <code class="docutils literal notranslate"><span class="pre">values</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s2</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([1, 2])
</pre></div>
</div>
</div>
<p>And the indices are available through the <code class="docutils literal notranslate"><span class="pre">index</span></code> attribute:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s2</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Int64Index([0, 5], dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
<p>The index is not simply a NumPy array, but a data structure that allows fast access to the elements. The indices need not be integers, as the next example shows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abcdef&quot;</span><span class="p">))</span>
<span class="n">s3</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>a    1
b    4
c    5
d    2
e    5
f    2
dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>4
</pre></div>
</div>
</div>
<div class="admonition warning">
Note a special case here: if the indices are not integers, then the last index of the slice is included in the result. This is contrary to slicing with integers!</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="s2">&quot;e&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>b    4
c    5
d    2
e    5
dtype: int64
</pre></div>
</div>
</div>
<p>It is still possible to access the series using NumPy style <em>implicit integer indices</em>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>4
</pre></div>
</div>
</div>
<p>This can be confusing though. Consider the following series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Jones&quot;</span><span class="p">,</span> <span class="s2">&quot;James&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">s4</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>1     Jack
2    Jones
3    James
dtype: object
</pre></div>
</div>
</div>
<p>What do you think <code class="docutils literal notranslate"><span class="pre">s4[1]</span></code> will print? For this ambiguity Pandas offers attributes <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">iloc</span></code>. The attributes <code class="docutils literal notranslate"><span class="pre">loc</span></code> always uses the explicit index, while the attribute <code class="docutils literal notranslate"><span class="pre">iloc</span></code> always uses the implicit integer index:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Jack
Jones
</pre></div></div>
</div>
<hr class="docutils" />
<div class="admonition note">
Exercise X (read series)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">read_series</span></code> that reads input lines from the user and return a Series. Each line should contain first the index and then the corresponding value, separated by whitespace. An empty line signals the end of Series.</p>
<p>Test your function from the <code class="docutils literal notranslate"><span class="pre">main</span></code> function.</p>
<hr class="docutils" />
<div class="admonition note">
Exercise X (operations on series)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">create_series</span></code> that get two lists of floats as parameters. Both lists should have length 3. The function should first create two Series, <code class="docutils literal notranslate"><span class="pre">s1</span></code> and <code class="docutils literal notranslate"><span class="pre">s2</span></code>. The first series should have values from the first parameter list and have corresponding indices <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, and <code class="docutils literal notranslate"><span class="pre">c</span></code>. The second series should get its values from the second parameter list and have again the corresponding indices <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, and <code class="docutils literal notranslate"><span class="pre">c</span></code>. The function should return the pair of these Series.</p>
<p>Then, write a function <code class="docutils literal notranslate"><span class="pre">modify_series</span></code> that gets two Series as parameters. It should add to the first Series <code class="docutils literal notranslate"><span class="pre">s1</span></code> a new value with index <code class="docutils literal notranslate"><span class="pre">d</span></code>. The new value should be the same as the value in Series <code class="docutils literal notranslate"><span class="pre">s2</span></code> with index <code class="docutils literal notranslate"><span class="pre">b</span></code>. Then delete the element from <code class="docutils literal notranslate"><span class="pre">s2</span></code> that has index <code class="docutils literal notranslate"><span class="pre">b</span></code>. Now the first Series should have four values, while the second list has only two values. Adding a new element to a Series can be achieved by assignment, like with dictionaries. Deletion of an element from a Series
can be done with the <code class="docutils literal notranslate"><span class="pre">del</span></code> statement.</p>
<p>Test these functions from the main function. Try adding together the Series returned by the <code class="docutils literal notranslate"><span class="pre">modify_series</span></code> function. The operations on Series use the indices to keep the element-wise operations <em>aligned</em>. If for some index the operation could not be performed, the resulting value will be <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not A Number).</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (inverse series)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">inverse_series</span></code> that get a Series as a parameter and returns a new series, whose indices and values have swapped roles. Test your function from the <code class="docutils literal notranslate"><span class="pre">main</span></code> function.</p>
<p>What happens if some value appears multiple times in the original Series? What happens if you use this value to index the resulting Series?</p>
<hr/><div class="section" id="Onko-seuraava-pätkä-tarpeen?">
<h3>Onko seuraava pätkä tarpeen?<a class="headerlink" href="#Onko-seuraava-pätkä-tarpeen?" title="Permalink to this headline">¶</a></h3>
<p>One may notice that there are similarities between Python’s dictionaries and Pandas’ Series, both can be thought to access values using keys. The difference is that Series requires that the indices have all the same type, and similarly, all the values have the same type. This restriction allows creation of fast data structures.</p>
<p>As a mark of the similaries between these two data structures, Pandas allows creation of a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object from a dictionary:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">2001</span> <span class="p">:</span> <span class="s2">&quot;Bush&quot;</span><span class="p">,</span> <span class="mi">2005</span><span class="p">:</span> <span class="s2">&quot;Bush&quot;</span><span class="p">,</span> <span class="mi">2009</span><span class="p">:</span> <span class="s2">&quot;Obama&quot;</span><span class="p">,</span> <span class="mi">2013</span><span class="p">:</span> <span class="s2">&quot;Obama&quot;</span><span class="p">,</span> <span class="mi">2017</span> <span class="p">:</span> <span class="s2">&quot;Trump&quot;</span><span class="p">}</span>
<span class="n">s4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Presidents&quot;</span><span class="p">)</span>
<span class="n">s4</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>2001     Bush
2005     Bush
2009    Obama
2013    Obama
2017    Trump
Name: Presidents, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Creation-of-dataframes">
<h2>Creation of dataframes<a class="headerlink" href="#Creation-of-dataframes" title="Permalink to this headline">¶</a></h2>
<p>The DataFrame is essentially a two dimensional object, and it can be created in three different ways:</p>
<ul class="simple">
<li>out of a two dimensional NumPy array</li>
<li>out of given columns</li>
<li>out of given rows</li>
</ul>
<div class="section" id="Creating-DataFrames-from-a-NumPy-array">
<h3>Creating DataFrames from a NumPy array<a class="headerlink" href="#Creating-DataFrames-from-a-NumPy-array" title="Permalink to this headline">¶</a></h3>
<p>In the following example a DataFrame with 2 rows and 3 column is created. The row and column indices are given explicitly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;First&quot;</span><span class="p">,</span> <span class="s2">&quot;Second&quot;</span><span class="p">,</span> <span class="s2">&quot;Third&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.218073</td>
      <td>0.445573</td>
      <td>-0.535462</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.483612</td>
      <td>0.571807</td>
      <td>-0.126999</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Note that now both the rows and columns can be accessed using the special <code class="docutils literal notranslate"><span class="pre">Index</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>                            <span class="c1"># These are the &quot;row names&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;a&#39;, &#39;b&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>                          <span class="c1"># These are the &quot;column names&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;First&#39;, &#39;Second&#39;, &#39;Third&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<p>If either <code class="docutils literal notranslate"><span class="pre">columns</span></code> or <code class="docutils literal notranslate"><span class="pre">index</span></code> argument is left out, then an integer index will be used:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.009853</td>
      <td>0.464225</td>
      <td>0.518682</td>
    </tr>
    <tr>
      <th>b</th>
      <td>-0.090749</td>
      <td>0.167984</td>
      <td>-0.753207</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Creating-DataFrames-from-columns">
<h3>Creating DataFrames from columns<a class="headerlink" href="#Creating-DataFrames-from-columns" title="Permalink to this headline">¶</a></h3>
<p>A columns can be specified as a list, an NumPy array, or a Pandas’ Series. The names of the columns can be given either with the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter, or if Series objects are use, then the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute of each Series is used as the column name.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">s1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1
1    2
2    3
dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    4
1    5
2    6
Name: b, dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If using multiple columns, then they must be given as the dictionary, whose keys give the column names and values are the actual column content.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">s1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">s2</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Creating-DataFrames-from-rows">
<h3>Creating DataFrames from rows<a class="headerlink" href="#Creating-DataFrames-from-rows" title="Permalink to this headline">¶</a></h3>
<p>We can give a list of rows as a parameter to the DataFrame constructor. If we want to give names for the columns, then either the rows can be dictionaries, where the key is the column name and the values are the elements of the DataFrame on that row and columns, or the column must be given explicitly. An example of this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s2">&quot;Wage&quot;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span> <span class="p">:</span> <span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span> <span class="p">:</span> <span class="mi">21</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;Wage&quot;</span> <span class="p">:</span> <span class="mi">1500</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span> <span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span> <span class="p">:</span> <span class="mi">29</span><span class="p">}])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Name</th>
      <th>Wage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>21</td>
      <td>Jack</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29</td>
      <td>John</td>
      <td>1500</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Or:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="mi">29</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Wage&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>Jack</td>
      <td>21</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1500</td>
      <td>John</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="admonition warning">
<p class="admonition-title fa fa-exclamation-circle">Note that the order of columns is not always the same order as they were in the parameter list. In this case you can use the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter to specify the exact order.</p>
<p>In the earlier case, however, where we created DataFrames from a dictionary of columns, the order of columns should be the same as in the parameter dictionary in the recent versions of Python and Pandas.</p>
</div>
<p>In the sense of information content the order of columns should not matter, but sometimes you want to specify a certain order to make the Frame more readable, or to make it obey some semantic meaning of column order.</p>
<hr class="docutils" />
<div class="admonition note">
Exercise X (cities)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">cities</span></code> that returns the following DataFrame of top Finnish cities by population:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                 <span class="n">Population</span> <span class="n">Total</span> <span class="n">area</span>
<span class="n">Helsinki</span>         <span class="mi">643272</span>     <span class="mf">715.48</span>
<span class="n">Espoo</span>            <span class="mi">279044</span>     <span class="mf">528.03</span>
<span class="n">Tampere</span>          <span class="mi">231853</span>     <span class="mf">689.59</span>
<span class="n">Vantaa</span>           <span class="mi">223027</span>     <span class="mf">240.35</span>
<span class="n">Oulu</span>             <span class="mi">201810</span>     <span class="mf">3817.52</span>
</pre></div>
</div>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (powers of series)</div>
<p>Make function <code class="docutils literal notranslate"><span class="pre">powers_of_series</span></code> that takes a Series and a positive integer <code class="docutils literal notranslate"><span class="pre">k</span></code> as parameters and returns a DataFrame. The resulting DataFrame should have to same index as the input Series. The first column of the dataFrame should be the input Series, the second column should contain the Series raised to power of two. The third column should contain the Series to the power of three, and so on until power of <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
<p>The values should be numbers, but the index can have any type. Test your function from the <code class="docutils literal notranslate"><span class="pre">main</span></code> function. Example of usage:</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (municipal information)</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">main</span></code> function load a data set of municipal information from the address <a class="reference external" href="https://www.cs.helsinki.fi/u/jttoivon/dap/data/statistics/municipal.tsv">https://www.cs.helsinki.fi/u/jttoivon/dap/data/statistics/municipal.tsv</a> (from <a class="reference external" href="https://pxnet2.stat.fi/PXWeb/pxweb/en/">Statistics Finland</a>). Use the function <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code>, and note that the separator in a tabulator and the encoding of the file is ISO-8859 (old format for certain European languages).</p>
<p>Print the shape of the DataFrame and the column names in the following format: Shape: r,c Columns: col1, col2, …</p>
<hr/></div>
</div>
<div class="section" id="Accessing-columns-and-rows-of-a-dataframe">
<h2>Accessing columns and rows of a dataframe<a class="headerlink" href="#Accessing-columns-and-rows-of-a-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Even though DataFrames are basically just two dimensional arrays, the way to access their elements is different from NumPy arrays. There are a couple of complications, which we will go through in this section.</p>
<p>Firstly, the bracket notation <code class="docutils literal notranslate"><span class="pre">[]</span></code> does not allow the use of an index pair to access a single element of the DataFrame. Instead only one dimension can be specified.</p>
<p>Well, does this dimension specify the rows of the DataFrame, like NumPy arrays if only one index is given, or does it specify the columns of the DataFrame?</p>
<p>It depends!</p>
<p>If an integer is used, then it specifies a column of the DataFrame in the case the <strong>explicit</strong> indices for the column contain that integer. In any other case an error will result. For example, with the above DataFrame, the following indexing will not work, because the explicit column index consist of the column names “Name” and “Wage” which are not integers.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Key error&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Key error
</pre></div></div>
</div>
<p>The following will however work.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Wage&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1000
1    1500
Name: Wage, dtype: int64
</pre></div>
</div>
</div>
<p>As does the fancy indexing:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Wage&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>Jack</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1500</td>
      <td>John</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If one indexes with a slice or a boolean mask, then the <strong>rows</strong> are referred to. Examples of these:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>                           <span class="c1"># slice</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>Jack</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Wage</span> <span class="o">&gt;</span> <span class="mi">1200</span><span class="p">]</span>               <span class="c1"># boolean mask</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1500</td>
      <td>John</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>If some of the above calls return a Series object, then you can chain the bracket calls to get a single value from the DataFrame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Wage&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>                    <span class="c1"># Note order of dimensions</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>1500
</pre></div>
</div>
</div>
<p>But there is a better way to achieve this, which we will see in the next section.</p>
<hr class="docutils" />
<div class="admonition note">
Exercise X (municipalities of finland)</div>
<p>Load again the municipal information DataFrame . The rows of the DataFrame correspond to various geographical areas of Finland. The first row is about Finland as a whole, then rows from Akaa to Ääneskoski are municipalities of Finland in alphabetical order. After that some larger regions are listed.</p>
<p>Write function <code class="docutils literal notranslate"><span class="pre">municipalities_of_finland</span></code> that returns a DataFrame containing only rows about municipalities.</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (swedish and foreigners)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">swedish_and_foreigners</span></code> that</p>
<ul class="simple">
<li>Reads the municipalities data set</li>
<li>Takes the subset about municipalities (like in previous exercise)</li>
<li>Further take a subset of rows that have proportion of swedish speaking people and proportion of foreigners both above 5 % level</li>
<li>From this data set take only columns about population and the proportions of Swedish speaking people and foreigners, that is three columns.</li>
</ul>
<p>Do you see some kind of correlation between the columns about Swedish speaking and foreign people? Do you see a correlation between the columns about the population and the proportion of Swedish speaking people in this subset?</p>
<hr class="docutils" />
<div class="admonition note">
Exercise X (growing municipalities)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">growing_municipalities</span></code> that gets a DataFrame as parameter and return the proportion municipalities with increasing population.</p>
<p>Test your function from the <code class="docutils literal notranslate"><span class="pre">main</span></code> function using some subset of the municipalities.</p>
<hr/></div>
<div class="section" id="Alternative-indexing-and-data-selection">
<h2>Alternative indexing and data selection<a class="headerlink" href="#Alternative-indexing-and-data-selection" title="Permalink to this headline">¶</a></h2>
<p>If the explanation in the previous section sounded confusing or ambiguous, or if you didn’t understand a thing, you don’t have to worry.</p>
<p>There is another way to index Pandas DataFrames, which</p>
<ul class="simple">
<li>allows index pairs to access a single element</li>
<li>has the same order of dimensions as NumPy: first index specifies rows, second columns</li>
<li>is not ambiguous about implicit or explicit indices</li>
</ul>
<p>Pandas DataFrames have attributes <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">iloc</span></code> that have the above qualities. You can use <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">iloc</span></code> attributes and forget everything about the previous section. Or you can use these attributes and sometimes use the methods from the previous section as shortcuts if you understand them well.</p>
<p>The difference between <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">iloc</span></code> attributes is that the former uses explicit indices and the latter uses the implicit integer indices. Examples of use:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Wage&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>1500
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>             <span class="c1"># Right lower corner of the DataFrame</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>29
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Wage&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Name    John
Wage    1500
Name: 1, dtype: object
</pre></div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">iloc</span></code> everything works like with NumPy arrays: indexing, slicing, fancy indexing, masking and their combinations. With <code class="docutils literal notranslate"><span class="pre">loc</span></code> it is the same but now the names in the explicit indices are used for specifying rows and columns. Make sure your understand why the above examples work as they do!</p>
<hr class="docutils" />
<div class="admonition note">
Exercise X (subsetting with loc)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">subsetting_with_loc</span></code> that in one go takes the subset of municipalities from Akaa to Ääneskoski and restricts it to columns: “Population”, “Share of Swedish-speakers of the population, %”, and “Share of foreign citizens of the population, %”. The function should return this content as a DataFrame. Use the attribute <code class="docutils literal notranslate"><span class="pre">loc</span></code>.</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (subsetting by positions)</div>
<p>Write function `` that does the following.</p>
<p>Read the data set of the top forty singles from the beginning of the year 1964 from <code class="docutils literal notranslate"><span class="pre">https://www.cs.helsinki.fi/u/jttoivon/dap/data/UK-top40-1964-1-2.tsv</span></code>. Return the top 10 entries and only the columns <code class="docutils literal notranslate"><span class="pre">Artist</span></code> and <code class="docutils literal notranslate"><span class="pre">Performer</span></code>. Get these elements by their positions, that is, by using the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> attribute. The function should return these as a DataFrame.</p>
<hr/></div>
<div class="section" id="Summary-statistics">
<h2>Summary statistics<a class="headerlink" href="#Summary-statistics" title="Permalink to this headline">¶</a></h2>
<p>The summary statistic methods work in a similar way as their counter parts in NumPy. By default, the aggregation is done over columns.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># taking averages over these is not very interesting</span>
<span class="n">wh2</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Precipitation amount (mm)    1.966301
Snow depth (cm)              0.966480
Air temperature (degC)       6.527123
Rainy                        0.158904
dtype: float64
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">describe</span></code> method of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object gives different summary statistics for each (numeric) column. The result is a DataFrame. This method gives a good overview of the data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>365.0</td>
      <td>365.000000</td>
      <td>365.000000</td>
      <td>365.000000</td>
      <td>358.000000</td>
      <td>365.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2017.0</td>
      <td>6.526027</td>
      <td>15.720548</td>
      <td>1.966301</td>
      <td>0.966480</td>
      <td>6.527123</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.0</td>
      <td>3.452584</td>
      <td>8.808321</td>
      <td>4.858423</td>
      <td>3.717472</td>
      <td>7.183934</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2017.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>-17.800000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2017.0</td>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>-1.000000</td>
      <td>-1.000000</td>
      <td>1.200000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2017.0</td>
      <td>7.000000</td>
      <td>16.000000</td>
      <td>0.200000</td>
      <td>-1.000000</td>
      <td>4.800000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2017.0</td>
      <td>10.000000</td>
      <td>23.000000</td>
      <td>2.700000</td>
      <td>0.000000</td>
      <td>12.900000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2017.0</td>
      <td>12.000000</td>
      <td>31.000000</td>
      <td>35.000000</td>
      <td>15.000000</td>
      <td>19.600000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<hr class="docutils" />
<div class="admonition note">
Exercise X (snow depth)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">snow_depth</span></code> that reads in the weather DataFrame and returns the maximum amount of snow in the year 2017.</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (average temperature)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">average_temperature</span></code> that returns the average temperature in July.</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (below zero)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">below_zero</span></code> that returns the number of days when the temperature was below zero.</p>
<hr/></div>
<div class="section" id="Missing-data">
<h2>Missing data<a class="headerlink" href="#Missing-data" title="Permalink to this headline">¶</a></h2>
<p>You may have noticed something strange in the output of the <code class="docutils literal notranslate"><span class="pre">describe</span></code> method. First, the minimum value in both precipitation and snow depth fields is -1. The special value -1 means that on that day there was absolutely no snow or rain, whereas the value 0 might indicate that the value was close to zero. Secondly, the snow depth column has count 358, whereas the other columns have count 365, one measurement/value for each day of the year. How is this possible? Every field in a DataFrame should
have the same number of rows. Let’s use the <code class="docutils literal notranslate"><span class="pre">unique</span></code> method of the Series object to find out, which different values are used in this column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="s2">&quot;Snow depth (cm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([-1.,  7., 13., 10., 12.,  9.,  8.,  5.,  6.,  4.,  3., 15., 14.,
        2., nan,  0.])
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">float</span></code> type allows a special value <code class="docutils literal notranslate"><span class="pre">nan</span></code> (Not A Number), in addition to normal floating point numbers. This value can represent the result from an illegal operation. For example, the operation 0/0 can either cause an exception to occur or just silently produce a <code class="docutils literal notranslate"><span class="pre">nan</span></code>. In Pandas <code class="docutils literal notranslate"><span class="pre">nan</span></code> can be used to represent a missing value. In the weather DataFrame the <code class="docutils literal notranslate"><span class="pre">nan</span></code> value tells us that the measurement from that day is not available, possibly due to a broken measuring instrument or some
other problem.</p>
<p>Note that only float types allow the <code class="docutils literal notranslate"><span class="pre">nan</span></code> value. So, if we try to create an integer series with missing values, its dtype gets promoted to <code class="docutils literal notranslate"><span class="pre">float</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1
1    3
2    2
dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    1.0
1    3.0
2    2.0
3    NaN
dtype: float64
</pre></div>
</div>
</div>
<p>For non-numeric types the special value <code class="docutils literal notranslate"><span class="pre">None</span></code> is used to denote the missing value, and the dtype is promoted to <code class="docutils literal notranslate"><span class="pre">object</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;jack&quot;</span><span class="p">,</span> <span class="s2">&quot;joe&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    jack
1     joe
2    None
dtype: object
</pre></div>
</div>
</div>
<p>Pandas excludes the missing values from the summary statistics, like we saw in the previous section. Pandas also provides some functions to handle missing values.</p>
<p>The missing values can be located with the <code class="docutils literal notranslate"><span class="pre">isnull</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>      <span class="c1"># returns a boolean mask DataFrame</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>13</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>17</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>23</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>25</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>335</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>336</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>337</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>338</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>339</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>340</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>341</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>342</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>343</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>344</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>345</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>346</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>347</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>348</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>349</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>350</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>351</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>352</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>353</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>354</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>355</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>356</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>357</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>358</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>359</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>360</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>361</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>362</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>363</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>364</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 9 columns</p>
</div></div>
</div>
<p>This is not very useful as we cannot directly use the mask to index the DataFrame. We can, however, combine it with the <code class="docutils literal notranslate"><span class="pre">any</span></code> method to find out all the rows that contain at least one missing value:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="p">[</span><span class="n">wh</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>74</th>
      <td>2017</td>
      <td>3</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.8</td>
      <td>NaN</td>
      <td>3.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>163</th>
      <td>2017</td>
      <td>6</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>NaN</td>
      <td>12.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>308</th>
      <td>2017</td>
      <td>11</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>NaN</td>
      <td>8.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>309</th>
      <td>2017</td>
      <td>11</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>7.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>313</th>
      <td>2017</td>
      <td>11</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.6</td>
      <td>NaN</td>
      <td>7.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>321</th>
      <td>2017</td>
      <td>11</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>11.3</td>
      <td>NaN</td>
      <td>5.9</td>
      <td>True</td>
    </tr>
    <tr>
      <th>328</th>
      <td>2017</td>
      <td>11</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.5</td>
      <td>NaN</td>
      <td>4.2</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">notnull</span></code> method works conversively to the <code class="docutils literal notranslate"><span class="pre">isnull</span></code> method.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dropna</span></code> method of a DataFrame drops columns or rows that contain missing values from the DataFrame, depending on the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>   <span class="c1"># Default axis is 0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(358, 9)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># Drops the columns containing missing values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(365, 8)
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">how</span></code> and <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameters of the <code class="docutils literal notranslate"><span class="pre">dropna</span></code> method allow one to specify how many values need to be missing in order for the row/column to be dropped.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">fillna</span></code> method allows to fill the missing values with some constant or interpolated values. The <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter can be:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">None</span></code>: use the given positional parameter as the constant to fill missing values with</li>
<li><code class="docutils literal notranslate"><span class="pre">ffill</span></code>: use the previous value to fill the current value</li>
<li><code class="docutils literal notranslate"><span class="pre">bfill</span></code>: use the next value to fill the current value</li>
</ul>
<p>For example, for the weather data we could use forward fill</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
<span class="n">wh</span><span class="p">[</span><span class="n">wh</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>m</th>
      <th>d</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation amount (mm)</th>
      <th>Snow depth (cm)</th>
      <th>Air temperature (degC)</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">interpolate</span></code> method, which we will not cover here, offers more elaborate ways to interpolate the missing values from their neighbouring non-missing values.</p>
<hr class="docutils" />
<div class="admonition note">
Exercise X (cyclists)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">cyclists</span></code> that does the following.</p>
<p>Load the Helsinki bicycle data set from address <code class="docutils literal notranslate"><span class="pre">https://www.cs.helsinki.fi/u/jttoivon/dap/data/hel/Helsingin_pyorailijamaarat.csv</span></code>. The dataset contain number of cyclists passing by measuring points per hour. The data is gathered over about four years, and there are 20 measuring points around Helsinki. The dataset contains some empty rows at the end. Get rid of these. Also, get rid of columns that contain only missing values. Return the cleaned dataset.</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (missing value types)</div>
<p>Make function <code class="docutils literal notranslate"><span class="pre">missing_value_types</span></code> that returns the following DataFrame. Use the <code class="docutils literal notranslate"><span class="pre">State</span></code> column as the (row) index. The value types for the two other columns should be <code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">object</span></code>, respectively. Replace the dashes with the appropriate missing value symbols.</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="43%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">State</th>
<th class="head">Year of Independence</th>
<th class="head">President</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>United Kingdom</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Finland</td>
<td>1917</td>
<td>Niinistö</td>
</tr>
<tr class="row-even"><td>USA</td>
<td>1776</td>
<td>Trump</td>
</tr>
<tr class="row-odd"><td>Sweden</td>
<td>1523</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Germany</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>Steinmeier</td>
</tr>
<tr class="row-odd"><td>Russia</td>
<td>1992</td>
<td>Putin</td>
</tr>
</tbody>
</table>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (special missing values)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">special_missing_values</span></code> that does the following.</p>
<p>Read the data set of the top forty singles from the beginning of the year 1964 from <code class="docutils literal notranslate"><span class="pre">https://www.cs.helsinki.fi/u/jttoivon/dap/data/UK-top40-1964-1-2.tsv</span></code>. Return the rows that relate to those singles whose position dropped compared to last week’s position (column LW=Last Week).</p>
<p>To do this you first have to convert the special values <code class="docutils literal notranslate"><span class="pre">New</span></code> and <code class="docutils literal notranslate"><span class="pre">Re</span></code> (Re-entry) to missing values (None).</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (last week)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">last_week</span></code> that reads the top40 data set mentioned in the above exercise. The function should then try to reconstruct the top40 list of the previous week based on that week’s list. Try to do this as well as possible. You can fill the values that are impossible to reconstruct by missing value symbols.</p>
<hr/></div>
<div class="section" id="String-processing">
<h2>String processing<a class="headerlink" href="#String-processing" title="Permalink to this headline">¶</a></h2>
<p>If the elements in a column are string, then the vectorized versions of Python’s string processing methods are available. These are accessed through the <code class="docutils literal notranslate"><span class="pre">str</span></code> attribute of a Series or a DataFrame. For example, to capitalize all the strings of a Series, we can use the <code class="docutils literal notranslate"><span class="pre">str.capitalize</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;donald&quot;</span><span class="p">,</span> <span class="s2">&quot;theresa&quot;</span><span class="p">,</span> <span class="s2">&quot;angela&quot;</span><span class="p">,</span> <span class="s2">&quot;vladimir&quot;</span><span class="p">])</span>
<span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0      Donald
1     Theresa
2      Angela
3    Vladimir
dtype: object
</pre></div>
</div>
</div>
<p>One can find all the available methods by pressing the tab key after the text <code class="docutils literal notranslate"><span class="pre">names.str.</span></code> in a Python prompt. Try it in below cell!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#names.str.</span>
</pre></div>
</div>
</div>
<p>We can split a column or Series into several columns using the <code class="docutils literal notranslate"><span class="pre">split</span></code> method. For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">full_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Donald Trump&quot;</span><span class="p">,</span> <span class="s2">&quot;Theresa May&quot;</span><span class="p">,</span> <span class="s2">&quot;Angela Merkel&quot;</span><span class="p">,</span> <span class="s2">&quot;Vladimir Putin&quot;</span><span class="p">])</span>
<span class="n">full_names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0      [Donald, Trump]
1       [Theresa, May]
2     [Angela, Merkel]
3    [Vladimir, Putin]
dtype: object
</pre></div>
</div>
</div>
<p>This is not exactly what we wanted: now each element is a list. We need to use the <code class="docutils literal notranslate"><span class="pre">expand</span></code> parameter to split into columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">full_names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Donald</td>
      <td>Trump</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Theresa</td>
      <td>May</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Angela</td>
      <td>Merkel</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vladimir</td>
      <td>Putin</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<hr class="docutils" />
<div class="admonition note">
Exercise X (split date)</div>
<p>Read again the bicycle data set from <code class="docutils literal notranslate"><span class="pre">https://www.cs.helsinki.fi/u/jttoivon/dap/data/hel/Helsingin_pyorailijamaarat.csv</span></code>, and clean it as in the earlier exercise. Then split the <code class="docutils literal notranslate"><span class="pre">Päivämäärä</span></code> column into a DataFrame with five columns, with column names <code class="docutils literal notranslate"><span class="pre">Weekday</span></code>, <code class="docutils literal notranslate"><span class="pre">Day</span></code>, <code class="docutils literal notranslate"><span class="pre">Month</span></code>, <code class="docutils literal notranslate"><span class="pre">Year</span></code>, and <code class="docutils literal notranslate"><span class="pre">Hour</span></code>. Note that you also need to to do some conversions. To get Hours, drop the colon and minutes. Convert field <code class="docutils literal notranslate"><span class="pre">Weekday</span></code> according the following rule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ma</span> <span class="o">-&gt;</span> <span class="n">Mon</span>
<span class="n">ti</span> <span class="o">-&gt;</span> <span class="n">Tue</span>
<span class="n">ke</span> <span class="o">-&gt;</span> <span class="n">Wed</span>
<span class="n">to</span> <span class="o">-&gt;</span> <span class="n">Thu</span>
<span class="n">pe</span> <span class="o">-&gt;</span> <span class="n">Fri</span>
<span class="n">la</span> <span class="o">-&gt;</span> <span class="n">Sat</span>
<span class="n">su</span> <span class="o">-&gt;</span> <span class="n">Sun</span>
</pre></div>
</div>
<p>Convert the <code class="docutils literal notranslate"><span class="pre">Month</span></code> column according to the following mapping</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tammi</span> <span class="mi">1</span>
<span class="n">helmi</span> <span class="mi">2</span>
<span class="n">maalis</span> <span class="mi">3</span>
<span class="n">huhti</span> <span class="mi">4</span>
<span class="n">touko</span> <span class="mi">5</span>
<span class="n">kesä</span> <span class="mi">6</span>
<span class="n">heinä</span> <span class="mi">7</span>
<span class="n">elo</span> <span class="mi">8</span>
<span class="n">syys</span> <span class="mi">9</span>
<span class="n">loka</span> <span class="mi">10</span>
<span class="n">marras</span> <span class="mi">11</span>
<span class="n">joulu</span> <span class="mi">12</span>
</pre></div>
</div>
<p>Create function <code class="docutils literal notranslate"><span class="pre">split_date</span></code> that does the above and returns a DataFrame with five columns.</p>
<p>So the first element in the <code class="docutils literal notranslate"><span class="pre">Päivämäärä</span></code> column of the original data set should be converted from <code class="docutils literal notranslate"><span class="pre">ke</span> <span class="pre">1</span> <span class="pre">tammi</span> <span class="pre">2014</span> <span class="pre">00:00</span></code> to <code class="docutils literal notranslate"><span class="pre">Wed</span> <span class="pre">1</span> <span class="pre">1</span> <span class="pre">2014</span> <span class="pre">0</span></code></p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (cleaning data)</div>
<p>The entries in the following table of US presidents are not uniformly formatted. Make function <code class="docutils literal notranslate"><span class="pre">cleaning_data</span></code> that reads the table from the tsv file <code class="docutils literal notranslate"><span class="pre">src/presidents</span></code> and return the cleaned version of it. Note, you must do the edits programmatically using the string edit methods, not by creating a new DataFrame by hand. The middle three columns should have an integer <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="18%" />
<col width="12%" />
<col width="17%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">President</th>
<th class="head">Start</th>
<th class="head">Last</th>
<th class="head">Seasons</th>
<th class="head">Vice-president</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>donald trump</td>
<td>2017 Jan</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>1</td>
<td>Mike Pence</td>
</tr>
<tr class="row-odd"><td>barack obama</td>
<td>2009</td>
<td>2017</td>
<td>2</td>
<td>Joe Biden</td>
</tr>
<tr class="row-even"><td>bush, george</td>
<td>2001</td>
<td>2009</td>
<td>2</td>
<td>Cheney, Dick</td>
</tr>
<tr class="row-odd"><td>Clinton, Bill</td>
<td>1993</td>
<td>2001</td>
<td>two</td>
<td>Gore, Al</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="Catenating-datasets">
<h2>Catenating datasets<a class="headerlink" href="#Catenating-datasets" title="Permalink to this headline">¶</a></h2>
<p>We already saw in the NumPy section how we can catenate arrays along an axis: axis=0 catenates vertically and axis=1 catenates horizontally, and so on. With the DataFrames of Pandas it works similarly except that the row indices and the column names require extra attention. Also note a slight difference in the name: <code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code> but <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code>.</p>
<p>Let’s start by considering catenation along the axis 0, that is, vertical catenation. We will first make a helper function to easily create DataFrames for testing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">makedf</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span> <span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next we will create some example DataFrames:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;AB&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">b</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;AB&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;CD&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span><span class="o">=</span><span class="n">makedf</span><span class="p">(</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
      <td>C3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the following simple case, the <code class="docutils literal notranslate"><span class="pre">concat</span></code> function works exactly as we expect it would:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">])</span>   <span class="c1"># The default axis is 0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The next, however, will create duplicate indices:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    A0
0    A0
Name: A, dtype: object
</pre></div>
</div>
</div>
<p>This is not usually what we want! There are three solutions to this. Firstly, deny creation of duplicated indices by giving the <code class="docutils literal notranslate"><span class="pre">verify_integrity</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">concat</span></code> function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Indexes have overlapping values: Int64Index([0, 1], dtype=&#39;int64&#39;)
</pre></div></div>
</div>
<p>Secondly, we can ask for automatic renumbering of rows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Thirdly, we can ask for <em>hierarchical indexing</em>. The indices can contain multiple levels, but on this course we don’t consider hierarchical indices in detail. Hierarchical indices can make a two dimensional array to work like higher dimensional array.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">])</span>
<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">first</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">second</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r2</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">][</span><span class="s2">&quot;first&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;A0&#39;
</pre></div>
</div>
</div>
<p>Everything works similarly, when we want to catenate horizontally:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We have so far assumed that when concatenating vertically the columns of both DataFrames are the same, and when joining horizontally the indices are the same. This is, however, not required:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/jttoivon/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:1: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass &#39;sort=True&#39;.

To retain the current behavior and silence the warning, pass sort=False

  &#34;&#34;&#34;Entry point for launching an IPython kernel.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>B3</td>
      <td>C3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>It expanded the non-existing cases with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s. This method is called an <em>outer join</em>, which forms the union of columns in the two DataFrames. The alternative is <em>inner join</em>, which forms the intersection of columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">d</span><span class="p">],</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<hr class="docutils" />
<div class="admonition note">
Exercise X (split date continues)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">split_date_continues</span></code> that does</p>
<ul class="simple">
<li>read the bicycle data set</li>
<li>clean the data set of columns/rows that contain only missing values</li>
<li>drops the <code class="docutils literal notranslate"><span class="pre">Päivämäärä</span></code> column and replaces it with its splitted components as before</li>
</ul>
<p>Use the <code class="docutils literal notranslate"><span class="pre">concat</span></code> function to do this. The function should return a DataFrame with 25 columns (first five related to the date and then the rest 20 conserning the measument location.</p>
<hr/></div>
<div class="section" id="Merging-dataframes">
<h2>Merging dataframes<a class="headerlink" href="#Merging-dataframes" title="Permalink to this headline">¶</a></h2>
<p>Merging combines two DataFrames based on some common field.</p>
<p>Let’s recall the earlier DataFrame about wages and ages of persons:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>Jack</td>
      <td>21</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1500</td>
      <td>John</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now, create a new DataFrame with the occupations of persons:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Name&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Jack&quot;</span><span class="p">],</span> <span class="s2">&quot;Occupation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Plumber&quot;</span><span class="p">,</span> <span class="s2">&quot;Carpenter&quot;</span><span class="p">]})</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Occupation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Plumber</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jack</td>
      <td>Carpenter</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The following function call will merge the two DataFrames on their common field, and, importantly, will keep the indices <em>aligned</em>. What this means is that even though the names are listed in different order in the two frames, the merge will still give correct result.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
      <th>Age</th>
      <th>Occupation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>Jack</td>
      <td>21</td>
      <td>Carpenter</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1500</td>
      <td>John</td>
      <td>29</td>
      <td>Plumber</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>This was an example of a simple one-to-one merge, where the keys in the <code class="docutils literal notranslate"><span class="pre">Name</span></code> columns had 1-to-1 correspondence. Sometimes not all the keys appear in both DataFrames:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df2</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s2">&quot;Name&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;James&quot;</span><span class="p">],</span> <span class="s2">&quot;Occupation&quot;</span><span class="p">:[</span><span class="s2">&quot;Painter&quot;</span><span class="p">]})],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Occupation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Plumber</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jack</td>
      <td>Carpenter</td>
    </tr>
    <tr>
      <th>2</th>
      <td>James</td>
      <td>Painter</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df3</span><span class="p">)</span>                <span class="c1"># By default an inner join is computed</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
      <th>Age</th>
      <th>Occupation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>Jack</td>
      <td>21</td>
      <td>Carpenter</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1500</td>
      <td>John</td>
      <td>29</td>
      <td>Plumber</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>   <span class="c1"># Outer join</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wage</th>
      <th>Name</th>
      <th>Age</th>
      <th>Occupation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000.0</td>
      <td>Jack</td>
      <td>21.0</td>
      <td>Carpenter</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1500.0</td>
      <td>John</td>
      <td>29.0</td>
      <td>Plumber</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>James</td>
      <td>NaN</td>
      <td>Painter</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Also, many-to-one and many-to-many relationships can occur in merges:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">books</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Title&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;War and Peace&quot;</span><span class="p">,</span> <span class="s2">&quot;Good Omens&quot;</span><span class="p">,</span> <span class="s2">&quot;Good Omens&quot;</span><span class="p">]</span> <span class="p">,</span>
                      <span class="s2">&quot;Author&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Tolstoi&quot;</span><span class="p">,</span> <span class="s2">&quot;Terry Pratchett&quot;</span><span class="p">,</span> <span class="s2">&quot;Neil Gaiman&quot;</span><span class="p">]})</span>
<span class="n">books</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>War and Peace</td>
      <td>Tolstoi</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Good Omens</td>
      <td>Terry Pratchett</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Good Omens</td>
      <td>Neil Gaiman</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">collections</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;Oodi&quot;</span><span class="p">,</span> <span class="s2">&quot;War and Peace&quot;</span><span class="p">],</span>
                           <span class="p">[</span><span class="s2">&quot;Oodi&quot;</span><span class="p">,</span> <span class="s2">&quot;Good Omens&quot;</span><span class="p">],</span>
                           <span class="p">[</span><span class="s2">&quot;Pasila&quot;</span><span class="p">,</span> <span class="s2">&quot;Good Omens&quot;</span><span class="p">],</span>
                           <span class="p">[</span><span class="s2">&quot;Kallio&quot;</span><span class="p">,</span> <span class="s2">&quot;War and Peace&quot;</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Library&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">])</span>
<span class="n">collections</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Library</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Oodi</td>
      <td>War and Peace</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Oodi</td>
      <td>Good Omens</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Pasila</td>
      <td>Good Omens</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kallio</td>
      <td>War and Peace</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>All combinations with matching keys (<code class="docutils literal notranslate"><span class="pre">Name</span></code>) are created:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">libraries_with_books_by</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="n">collections</span><span class="p">)</span>
<span class="n">libraries_with_books_by</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Author</th>
      <th>Library</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>War and Peace</td>
      <td>Tolstoi</td>
      <td>Oodi</td>
    </tr>
    <tr>
      <th>1</th>
      <td>War and Peace</td>
      <td>Tolstoi</td>
      <td>Kallio</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Good Omens</td>
      <td>Terry Pratchett</td>
      <td>Oodi</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Good Omens</td>
      <td>Terry Pratchett</td>
      <td>Pasila</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Good Omens</td>
      <td>Neil Gaiman</td>
      <td>Oodi</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Good Omens</td>
      <td>Neil Gaiman</td>
      <td>Pasila</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<hr class="docutils" />
<div class="admonition note">
Exercise X (cycling weather)</div>
<p>Merge the cycling and weather data sets along the columns year, month, and day. Note that the names of these columns might be different in the two tables.</p>
<p>Write function <code class="docutils literal notranslate"><span class="pre">cycling_weather</span></code> that reads the data sets and returns the merged DataFrame.</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (cycling weather)</div>
<p>Merge the DataFrames UK top40 and the bands DataFrame (<code class="docutils literal notranslate"><span class="pre">ttps://www.cs.helsinki.fi/u/jttoivon/dap/data/bands.tsv</span></code>).</p>
<hr/></div>
<div class="section" id="Aggregates-and-groupings">
<h2>Aggregates and groupings<a class="headerlink" href="#Aggregates-and-groupings" title="Permalink to this headline">¶</a></h2>
<p>Let us use again the weather dataset. First, we make the column names a bit more uniform and concise. For example the columns <code class="docutils literal notranslate"><span class="pre">Year</span></code>, <code class="docutils literal notranslate"><span class="pre">m</span></code>, and <code class="docutils literal notranslate"><span class="pre">d</span></code> are not uniformly named.</p>
<p>We can easily change the column names with the <code class="docutils literal notranslate"><span class="pre">rename</span></code> method of the DataFrame. Note that we cannot directly change the index <code class="docutils literal notranslate"><span class="pre">wh.columns</span></code> as it is immutable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh3</span> <span class="o">=</span> <span class="n">wh</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="s2">&quot;Month&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="s2">&quot;Day&quot;</span><span class="p">,</span> <span class="s2">&quot;Precipitation amount (mm)&quot;</span> <span class="p">:</span> <span class="s2">&quot;Precipitation&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Snow depth (cm)&quot;</span> <span class="p">:</span> <span class="s2">&quot;Snow&quot;</span><span class="p">,</span> <span class="s2">&quot;Air temperature (degC)&quot;</span> <span class="p">:</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">})</span>
<span class="n">wh3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Pandas has an operation that splits a DataFrame into groups, performs some operation on each of the groups, and then combines the result from each group into a resulting DataFrame. This split-apply-combine functionality is really flexible and powerful operation. In Pandas you start by calling the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method, which splits the DataFrame into groups. In the following example the rows that contain measurements from the same month belong to the same group:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groups</span> <span class="o">=</span> <span class="n">wh3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Month&quot;</span><span class="p">)</span>
<span class="n">groups</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;pandas.core.groupby.groupby.DataFrameGroupBy object at 0x7ff8972d8550&gt;
</pre></div>
</div>
</div>
<p>Nothing happened yet, but the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> object knows how the division into groups is done. We can query the number of groups in the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>12
</pre></div>
</div>
</div>
<p>We can iterate through all the groups:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1 31
2 28
3 31
4 30
5 31
6 30
7 31
8 31
9 30
10 31
11 30
12 31
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                 <span class="c1"># Group with index two is February</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>2017</td>
      <td>2</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.5</td>
      <td>4.0</td>
      <td>-0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2017</td>
      <td>2</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>-0.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2017</td>
      <td>2</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>6.0</td>
      <td>-0.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2017</td>
      <td>2</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.7</td>
      <td>6.0</td>
      <td>0.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2017</td>
      <td>2</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>7.0</td>
      <td>-2.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2017</td>
      <td>2</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>7.0</td>
      <td>-7.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2017</td>
      <td>2</td>
      <td>7</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-12.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>2017</td>
      <td>2</td>
      <td>8</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-8.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2017</td>
      <td>2</td>
      <td>9</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-10.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>2017</td>
      <td>2</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-8.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2017</td>
      <td>2</td>
      <td>11</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-5.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2017</td>
      <td>2</td>
      <td>12</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-2.7</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2017</td>
      <td>2</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>1.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2017</td>
      <td>2</td>
      <td>14</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>4.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2017</td>
      <td>2</td>
      <td>15</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2017</td>
      <td>2</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.9</td>
      <td>8.0</td>
      <td>0.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2017</td>
      <td>2</td>
      <td>17</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>8.0</td>
      <td>1.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>2017</td>
      <td>2</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>49</th>
      <td>2017</td>
      <td>2</td>
      <td>19</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.1</td>
      <td>5.0</td>
      <td>2.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2017</td>
      <td>2</td>
      <td>20</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.8</td>
      <td>3.0</td>
      <td>0.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>51</th>
      <td>2017</td>
      <td>2</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>7.0</td>
      <td>-2.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>52</th>
      <td>2017</td>
      <td>2</td>
      <td>22</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>12.2</td>
      <td>6.0</td>
      <td>-4.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2017</td>
      <td>2</td>
      <td>23</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>15.0</td>
      <td>-0.7</td>
      <td>False</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2017</td>
      <td>2</td>
      <td>24</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-5.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>55</th>
      <td>2017</td>
      <td>2</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.4</td>
      <td>13.0</td>
      <td>-5.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2017</td>
      <td>2</td>
      <td>26</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.5</td>
      <td>12.0</td>
      <td>-2.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2017</td>
      <td>2</td>
      <td>27</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>-2.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2017</td>
      <td>2</td>
      <td>28</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>7.7</td>
      <td>13.0</td>
      <td>2.1</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> object functions a bit like a DataFrame, so some operations which are allowed for DataFrames are also allowed for the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> object. For example, we can get a subset of columns:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groups</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;pandas.core.groupby.groupby.SeriesGroupBy object at 0x7ff89726e048&gt;
</pre></div>
</div>
</div>
<p>For each DataFrame corresponding to a group the Temperature column was chosen. Still nothing was shown, because we haven’t applied any operation on the groups.</p>
<p>The common methods also include the aggregation methods. Let’s try to apply the <code class="docutils literal notranslate"><span class="pre">mean</span></code> aggregation:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groups</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Month
1     -2.316129
2     -2.389286
3      0.983871
4      2.676667
5      9.783871
6     13.726667
7     16.035484
8     16.183871
9     11.826667
10     5.454839
11     3.950000
12     1.741935
Name: Temperature, dtype: float64
</pre></div>
</div>
</div>
<p>Now what happened was that after the mean aggregation was performed on each group, the results were automatically combined into a resulting DataFrame. Let’s try some other aggregation:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">groups</span><span class="p">[</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Month
1      26.9
2      21.0
3      29.7
4      26.9
5      -5.9
6      59.3
7      14.2
8      70.1
9      51.2
10    173.5
11    117.2
12    133.6
Name: Precipitation, dtype: float64
</pre></div>
</div>
</div>
<p>Ok, the -1.0 values in the Precipitation field are causing trouble here, let’s convert them to zeros:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh4</span> <span class="o">=</span> <span class="n">wh3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">wh4</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wh4</span><span class="o">.</span><span class="n">Precipitation</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Precipitation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">wh4</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">wh4</span><span class="o">.</span><span class="n">Snow</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Snow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">wh4</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>0.0</td>
      <td>-3.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>-12.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh4</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Month&quot;</span><span class="p">)[</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Month
1      38.9
2      35.0
3      41.7
4      39.9
5      16.1
6      76.3
7      31.2
8      86.1
9      65.2
10    184.5
11    120.2
12    140.6
Name: Precipitation, dtype: float64
</pre></div>
</div>
</div>
<div class="section" id="Other-ways-to-operate-on-groups">
<h3>Other ways to operate on groups<a class="headerlink" href="#Other-ways-to-operate-on-groups" title="Permalink to this headline">¶</a></h3>
<p>The aggregations are not the only possible operations on groups. The other possibilities are filtering, transformation, and application.</p>
<p>In <strong>filtering</strong> some of the groups can be filtered out.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">myfilter</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>                                     <span class="c1"># The filter function must return a boolean value</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">150</span>

<span class="n">wh4</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">myfilter</span><span class="p">)</span>                 <span class="c1"># Filter out months with total precipitation less that 150 mm</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>273</th>
      <td>2017</td>
      <td>10</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>274</th>
      <td>2017</td>
      <td>10</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.4</td>
      <td>0.0</td>
      <td>9.2</td>
      <td>True</td>
    </tr>
    <tr>
      <th>275</th>
      <td>2017</td>
      <td>10</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>21.5</td>
      <td>0.0</td>
      <td>8.3</td>
      <td>True</td>
    </tr>
    <tr>
      <th>276</th>
      <td>2017</td>
      <td>10</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>12.7</td>
      <td>0.0</td>
      <td>11.2</td>
      <td>True</td>
    </tr>
    <tr>
      <th>277</th>
      <td>2017</td>
      <td>10</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>8.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>278</th>
      <td>2017</td>
      <td>10</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.7</td>
      <td>0.0</td>
      <td>7.7</td>
      <td>False</td>
    </tr>
    <tr>
      <th>279</th>
      <td>2017</td>
      <td>10</td>
      <td>7</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>11.7</td>
      <td>0.0</td>
      <td>8.1</td>
      <td>True</td>
    </tr>
    <tr>
      <th>280</th>
      <td>2017</td>
      <td>10</td>
      <td>8</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>14.1</td>
      <td>0.0</td>
      <td>9.3</td>
      <td>True</td>
    </tr>
    <tr>
      <th>281</th>
      <td>2017</td>
      <td>10</td>
      <td>9</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>18.3</td>
      <td>0.0</td>
      <td>8.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>282</th>
      <td>2017</td>
      <td>10</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>24.2</td>
      <td>0.0</td>
      <td>8.1</td>
      <td>True</td>
    </tr>
    <tr>
      <th>283</th>
      <td>2017</td>
      <td>10</td>
      <td>11</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.5</td>
      <td>0.0</td>
      <td>6.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>284</th>
      <td>2017</td>
      <td>10</td>
      <td>12</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>18.1</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>285</th>
      <td>2017</td>
      <td>10</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>286</th>
      <td>2017</td>
      <td>10</td>
      <td>14</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>7.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>287</th>
      <td>2017</td>
      <td>10</td>
      <td>15</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.3</td>
      <td>0.0</td>
      <td>8.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>288</th>
      <td>2017</td>
      <td>10</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.7</td>
      <td>False</td>
    </tr>
    <tr>
      <th>289</th>
      <td>2017</td>
      <td>10</td>
      <td>17</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.6</td>
      <td>0.0</td>
      <td>8.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>290</th>
      <td>2017</td>
      <td>10</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>291</th>
      <td>2017</td>
      <td>10</td>
      <td>19</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.9</td>
      <td>0.0</td>
      <td>4.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>292</th>
      <td>2017</td>
      <td>10</td>
      <td>20</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>293</th>
      <td>2017</td>
      <td>10</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>294</th>
      <td>2017</td>
      <td>10</td>
      <td>22</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>295</th>
      <td>2017</td>
      <td>10</td>
      <td>23</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>296</th>
      <td>2017</td>
      <td>10</td>
      <td>24</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>297</th>
      <td>2017</td>
      <td>10</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.5</td>
      <td>0.0</td>
      <td>2.1</td>
      <td>True</td>
    </tr>
    <tr>
      <th>298</th>
      <td>2017</td>
      <td>10</td>
      <td>26</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>12.3</td>
      <td>2.0</td>
      <td>0.3</td>
      <td>True</td>
    </tr>
    <tr>
      <th>299</th>
      <td>2017</td>
      <td>10</td>
      <td>27</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.7</td>
      <td>7.0</td>
      <td>-0.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>300</th>
      <td>2017</td>
      <td>10</td>
      <td>28</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>17.1</td>
      <td>4.0</td>
      <td>3.3</td>
      <td>True</td>
    </tr>
    <tr>
      <th>301</th>
      <td>2017</td>
      <td>10</td>
      <td>29</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.3</td>
      <td>0.0</td>
      <td>2.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>302</th>
      <td>2017</td>
      <td>10</td>
      <td>30</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>303</th>
      <td>2017</td>
      <td>10</td>
      <td>31</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.4</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In a <strong>tranformation</strong> each group’s DataFrame is manipulated in a way that retains its shape. An example of centering values, so that the deviations from the monthly means are shown:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">wh4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span>
           <span class="n">wh4</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Month&quot;</span><span class="p">)[[</span><span class="s2">&quot;Precipitation&quot;</span><span class="p">,</span> <span class="s2">&quot;Snow&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())],</span>
          <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>-1.254839</td>
      <td>-6.903226</td>
      <td>2.916129</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>3.145161</td>
      <td>-6.903226</td>
      <td>-1.583871</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>5.345161</td>
      <td>0.096774</td>
      <td>-4.183871</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>-1.254839</td>
      <td>6.096774</td>
      <td>-10.483871</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>-1.254839</td>
      <td>3.096774</td>
      <td>-15.483871</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2017</td>
      <td>1</td>
      <td>6</td>
      <td>-0.954839</td>
      <td>3.096774</td>
      <td>-15.483871</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2017</td>
      <td>1</td>
      <td>7</td>
      <td>4.045161</td>
      <td>3.096774</td>
      <td>-1.483871</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2017</td>
      <td>1</td>
      <td>8</td>
      <td>-1.254839</td>
      <td>5.096774</td>
      <td>1.816129</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2017</td>
      <td>1</td>
      <td>9</td>
      <td>-0.154839</td>
      <td>5.096774</td>
      <td>2.816129</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2017</td>
      <td>1</td>
      <td>10</td>
      <td>-0.954839</td>
      <td>2.096774</td>
      <td>4.016129</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2017</td>
      <td>1</td>
      <td>11</td>
      <td>-1.254839</td>
      <td>0.096774</td>
      <td>0.716129</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2017</td>
      <td>1</td>
      <td>12</td>
      <td>6.745161</td>
      <td>0.096774</td>
      <td>-0.483871</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2017</td>
      <td>1</td>
      <td>13</td>
      <td>-1.154839</td>
      <td>6.096774</td>
      <td>3.416129</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2017</td>
      <td>1</td>
      <td>14</td>
      <td>-1.154839</td>
      <td>1.096774</td>
      <td>3.116129</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2017</td>
      <td>1</td>
      <td>15</td>
      <td>-1.254839</td>
      <td>1.096774</td>
      <td>-0.483871</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2017</td>
      <td>1</td>
      <td>16</td>
      <td>-1.254839</td>
      <td>1.096774</td>
      <td>-1.883871</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2017</td>
      <td>1</td>
      <td>17</td>
      <td>-1.054839</td>
      <td>1.096774</td>
      <td>-1.183871</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2017</td>
      <td>1</td>
      <td>18</td>
      <td>-0.354839</td>
      <td>1.096774</td>
      <td>3.416129</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2017</td>
      <td>1</td>
      <td>19</td>
      <td>-1.254839</td>
      <td>-1.903226</td>
      <td>3.916129</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2017</td>
      <td>1</td>
      <td>20</td>
      <td>-0.954839</td>
      <td>-1.903226</td>
      <td>1.716129</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2017</td>
      <td>1</td>
      <td>21</td>
      <td>-0.854839</td>
      <td>-1.903226</td>
      <td>0.516129</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2017</td>
      <td>1</td>
      <td>22</td>
      <td>-1.054839</td>
      <td>-1.903226</td>
      <td>3.316129</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2017</td>
      <td>1</td>
      <td>23</td>
      <td>-1.154839</td>
      <td>-0.903226</td>
      <td>2.416129</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2017</td>
      <td>1</td>
      <td>24</td>
      <td>-1.254839</td>
      <td>-0.903226</td>
      <td>0.116129</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2017</td>
      <td>1</td>
      <td>25</td>
      <td>-0.654839</td>
      <td>-0.903226</td>
      <td>-1.483871</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2017</td>
      <td>1</td>
      <td>26</td>
      <td>-1.254839</td>
      <td>-0.903226</td>
      <td>4.216129</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2017</td>
      <td>1</td>
      <td>27</td>
      <td>-1.254839</td>
      <td>-2.903226</td>
      <td>3.916129</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2017</td>
      <td>1</td>
      <td>28</td>
      <td>0.545161</td>
      <td>-2.903226</td>
      <td>3.116129</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2017</td>
      <td>1</td>
      <td>29</td>
      <td>1.345161</td>
      <td>-3.903226</td>
      <td>2.916129</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2017</td>
      <td>1</td>
      <td>30</td>
      <td>4.345161</td>
      <td>-1.903226</td>
      <td>3.316129</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>335</th>
      <td>2017</td>
      <td>12</td>
      <td>2</td>
      <td>0.764516</td>
      <td>3.516129</td>
      <td>-0.341935</td>
    </tr>
    <tr>
      <th>336</th>
      <td>2017</td>
      <td>12</td>
      <td>3</td>
      <td>2.664516</td>
      <td>-1.483871</td>
      <td>3.258065</td>
    </tr>
    <tr>
      <th>337</th>
      <td>2017</td>
      <td>12</td>
      <td>4</td>
      <td>-4.535484</td>
      <td>-1.483871</td>
      <td>-0.441935</td>
    </tr>
    <tr>
      <th>338</th>
      <td>2017</td>
      <td>12</td>
      <td>5</td>
      <td>-3.835484</td>
      <td>-1.483871</td>
      <td>-1.741935</td>
    </tr>
    <tr>
      <th>339</th>
      <td>2017</td>
      <td>12</td>
      <td>6</td>
      <td>-4.535484</td>
      <td>-1.483871</td>
      <td>-2.941935</td>
    </tr>
    <tr>
      <th>340</th>
      <td>2017</td>
      <td>12</td>
      <td>7</td>
      <td>11.764516</td>
      <td>-1.483871</td>
      <td>-2.541935</td>
    </tr>
    <tr>
      <th>341</th>
      <td>2017</td>
      <td>12</td>
      <td>8</td>
      <td>-2.535484</td>
      <td>-1.483871</td>
      <td>3.458065</td>
    </tr>
    <tr>
      <th>342</th>
      <td>2017</td>
      <td>12</td>
      <td>9</td>
      <td>-4.335484</td>
      <td>-1.483871</td>
      <td>2.458065</td>
    </tr>
    <tr>
      <th>343</th>
      <td>2017</td>
      <td>12</td>
      <td>10</td>
      <td>-4.535484</td>
      <td>-1.483871</td>
      <td>0.258065</td>
    </tr>
    <tr>
      <th>344</th>
      <td>2017</td>
      <td>12</td>
      <td>11</td>
      <td>-3.235484</td>
      <td>-1.483871</td>
      <td>-0.341935</td>
    </tr>
    <tr>
      <th>345</th>
      <td>2017</td>
      <td>12</td>
      <td>12</td>
      <td>30.464516</td>
      <td>-1.483871</td>
      <td>-0.141935</td>
    </tr>
    <tr>
      <th>346</th>
      <td>2017</td>
      <td>12</td>
      <td>13</td>
      <td>-0.335484</td>
      <td>3.516129</td>
      <td>-0.141935</td>
    </tr>
    <tr>
      <th>347</th>
      <td>2017</td>
      <td>12</td>
      <td>14</td>
      <td>0.664516</td>
      <td>2.516129</td>
      <td>-0.141935</td>
    </tr>
    <tr>
      <th>348</th>
      <td>2017</td>
      <td>12</td>
      <td>15</td>
      <td>5.464516</td>
      <td>8.516129</td>
      <td>-0.041935</td>
    </tr>
    <tr>
      <th>349</th>
      <td>2017</td>
      <td>12</td>
      <td>16</td>
      <td>-3.235484</td>
      <td>4.516129</td>
      <td>0.658065</td>
    </tr>
    <tr>
      <th>350</th>
      <td>2017</td>
      <td>12</td>
      <td>17</td>
      <td>-4.535484</td>
      <td>3.516129</td>
      <td>-1.641935</td>
    </tr>
    <tr>
      <th>351</th>
      <td>2017</td>
      <td>12</td>
      <td>18</td>
      <td>-1.035484</td>
      <td>3.516129</td>
      <td>0.258065</td>
    </tr>
    <tr>
      <th>352</th>
      <td>2017</td>
      <td>12</td>
      <td>19</td>
      <td>-4.335484</td>
      <td>1.516129</td>
      <td>-0.741935</td>
    </tr>
    <tr>
      <th>353</th>
      <td>2017</td>
      <td>12</td>
      <td>20</td>
      <td>-0.935484</td>
      <td>1.516129</td>
      <td>0.858065</td>
    </tr>
    <tr>
      <th>354</th>
      <td>2017</td>
      <td>12</td>
      <td>21</td>
      <td>-4.535484</td>
      <td>-1.483871</td>
      <td>0.758065</td>
    </tr>
    <tr>
      <th>355</th>
      <td>2017</td>
      <td>12</td>
      <td>22</td>
      <td>-4.535484</td>
      <td>-1.483871</td>
      <td>-1.841935</td>
    </tr>
    <tr>
      <th>356</th>
      <td>2017</td>
      <td>12</td>
      <td>23</td>
      <td>3.064516</td>
      <td>-1.483871</td>
      <td>-0.541935</td>
    </tr>
    <tr>
      <th>357</th>
      <td>2017</td>
      <td>12</td>
      <td>24</td>
      <td>-4.535484</td>
      <td>-1.483871</td>
      <td>-2.041935</td>
    </tr>
    <tr>
      <th>358</th>
      <td>2017</td>
      <td>12</td>
      <td>25</td>
      <td>1.364516</td>
      <td>-1.483871</td>
      <td>-1.441935</td>
    </tr>
    <tr>
      <th>359</th>
      <td>2017</td>
      <td>12</td>
      <td>26</td>
      <td>3.264516</td>
      <td>-1.483871</td>
      <td>0.158065</td>
    </tr>
    <tr>
      <th>360</th>
      <td>2017</td>
      <td>12</td>
      <td>27</td>
      <td>-3.435484</td>
      <td>-1.483871</td>
      <td>2.058065</td>
    </tr>
    <tr>
      <th>361</th>
      <td>2017</td>
      <td>12</td>
      <td>28</td>
      <td>-0.835484</td>
      <td>-1.483871</td>
      <td>1.058065</td>
    </tr>
    <tr>
      <th>362</th>
      <td>2017</td>
      <td>12</td>
      <td>29</td>
      <td>3.264516</td>
      <td>-1.483871</td>
      <td>2.058065</td>
    </tr>
    <tr>
      <th>363</th>
      <td>2017</td>
      <td>12</td>
      <td>30</td>
      <td>-0.435484</td>
      <td>-1.483871</td>
      <td>0.758065</td>
    </tr>
    <tr>
      <th>364</th>
      <td>2017</td>
      <td>12</td>
      <td>31</td>
      <td>-1.335484</td>
      <td>-1.483871</td>
      <td>-0.141935</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 6 columns</p>
</div></div>
</div>
<p>The <strong>apply</strong> method is very generic and only requires that for each group’s DataFrame the given function returns a DataFrame, Series, or a scalar. In the following example, we sort within each group by the temperature:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh4</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df</span> <span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="30" valign="top">1</th>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2017</td>
      <td>1</td>
      <td>6</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>-12.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
      <td>True</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2017</td>
      <td>1</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>-4.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>0.0</td>
      <td>-3.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2017</td>
      <td>1</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>6.0</td>
      <td>-3.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2017</td>
      <td>1</td>
      <td>7</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.3</td>
      <td>10.0</td>
      <td>-3.8</td>
      <td>True</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2017</td>
      <td>1</td>
      <td>17</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>8.0</td>
      <td>-3.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2017</td>
      <td>1</td>
      <td>12</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>-2.8</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2017</td>
      <td>1</td>
      <td>15</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>-2.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2017</td>
      <td>1</td>
      <td>24</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>-2.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2017</td>
      <td>1</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.4</td>
      <td>5.0</td>
      <td>-1.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2017</td>
      <td>1</td>
      <td>11</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>-1.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2017</td>
      <td>1</td>
      <td>20</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>5.0</td>
      <td>-0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2017</td>
      <td>1</td>
      <td>8</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>-0.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2017</td>
      <td>1</td>
      <td>23</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>6.0</td>
      <td>0.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2017</td>
      <td>1</td>
      <td>31</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2017</td>
      <td>1</td>
      <td>9</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.1</td>
      <td>12.0</td>
      <td>0.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2017</td>
      <td>1</td>
      <td>29</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.6</td>
      <td>3.0</td>
      <td>0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2017</td>
      <td>1</td>
      <td>14</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>8.0</td>
      <td>0.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2017</td>
      <td>1</td>
      <td>28</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.8</td>
      <td>4.0</td>
      <td>0.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2017</td>
      <td>1</td>
      <td>30</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.6</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2017</td>
      <td>1</td>
      <td>22</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2017</td>
      <td>1</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>13.0</td>
      <td>1.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2017</td>
      <td>1</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.9</td>
      <td>8.0</td>
      <td>1.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2017</td>
      <td>1</td>
      <td>19</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2017</td>
      <td>1</td>
      <td>27</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>1.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2017</td>
      <td>1</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>9.0</td>
      <td>1.7</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="30" valign="top">12</th>
      <th>340</th>
      <td>2017</td>
      <td>12</td>
      <td>7</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>16.3</td>
      <td>0.0</td>
      <td>-0.8</td>
      <td>True</td>
    </tr>
    <tr>
      <th>357</th>
      <td>2017</td>
      <td>12</td>
      <td>24</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>355</th>
      <td>2017</td>
      <td>12</td>
      <td>22</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>338</th>
      <td>2017</td>
      <td>12</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.7</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>350</th>
      <td>2017</td>
      <td>12</td>
      <td>17</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>358</th>
      <td>2017</td>
      <td>12</td>
      <td>25</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.9</td>
      <td>0.0</td>
      <td>0.3</td>
      <td>True</td>
    </tr>
    <tr>
      <th>334</th>
      <td>2017</td>
      <td>12</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.4</td>
      <td>0.0</td>
      <td>0.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>352</th>
      <td>2017</td>
      <td>12</td>
      <td>19</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>356</th>
      <td>2017</td>
      <td>12</td>
      <td>23</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>7.6</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>True</td>
    </tr>
    <tr>
      <th>337</th>
      <td>2017</td>
      <td>12</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>False</td>
    </tr>
    <tr>
      <th>335</th>
      <td>2017</td>
      <td>12</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.3</td>
      <td>5.0</td>
      <td>1.4</td>
      <td>True</td>
    </tr>
    <tr>
      <th>344</th>
      <td>2017</td>
      <td>12</td>
      <td>11</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.3</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>364</th>
      <td>2017</td>
      <td>12</td>
      <td>31</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.2</td>
      <td>0.0</td>
      <td>1.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>346</th>
      <td>2017</td>
      <td>12</td>
      <td>13</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.2</td>
      <td>5.0</td>
      <td>1.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>345</th>
      <td>2017</td>
      <td>12</td>
      <td>12</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>1.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>347</th>
      <td>2017</td>
      <td>12</td>
      <td>14</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.2</td>
      <td>4.0</td>
      <td>1.6</td>
      <td>True</td>
    </tr>
    <tr>
      <th>348</th>
      <td>2017</td>
      <td>12</td>
      <td>15</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>1.7</td>
      <td>True</td>
    </tr>
    <tr>
      <th>359</th>
      <td>2017</td>
      <td>12</td>
      <td>26</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>7.8</td>
      <td>0.0</td>
      <td>1.9</td>
      <td>True</td>
    </tr>
    <tr>
      <th>351</th>
      <td>2017</td>
      <td>12</td>
      <td>18</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.5</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>343</th>
      <td>2017</td>
      <td>12</td>
      <td>10</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>349</th>
      <td>2017</td>
      <td>12</td>
      <td>16</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.3</td>
      <td>6.0</td>
      <td>2.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>363</th>
      <td>2017</td>
      <td>12</td>
      <td>30</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.1</td>
      <td>0.0</td>
      <td>2.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>354</th>
      <td>2017</td>
      <td>12</td>
      <td>21</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>353</th>
      <td>2017</td>
      <td>12</td>
      <td>20</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.6</td>
      <td>3.0</td>
      <td>2.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>361</th>
      <td>2017</td>
      <td>12</td>
      <td>28</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>3.7</td>
      <td>0.0</td>
      <td>2.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>360</th>
      <td>2017</td>
      <td>12</td>
      <td>27</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.1</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>362</th>
      <td>2017</td>
      <td>12</td>
      <td>29</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>7.8</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>True</td>
    </tr>
    <tr>
      <th>342</th>
      <td>2017</td>
      <td>12</td>
      <td>9</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>4.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>336</th>
      <td>2017</td>
      <td>12</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>7.2</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>341</th>
      <td>2017</td>
      <td>12</td>
      <td>8</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.2</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 9 columns</p>
</div></div>
</div>
<hr class="docutils" />
<div class="admonition note">
Exercise X (cyclists per day)</div>
<p>Read and clean the bicycle data set as usual. Group the rows by year, month, and day. Get the sum for each group.</p>
<p>Part 1.</p>
<p>Make function <code class="docutils literal notranslate"><span class="pre">cyclists_per_day</span></code> that does the above. The function should return a DataFrame (now with the Hour column).</p>
<p>Part 2.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">main</span></code> function, using the function <code class="docutils literal notranslate"><span class="pre">cyclists_per_day</span></code>, get the daily counts, restrict this data to July of year 2017, and plot this data. The x-axis should have ticks from 1 to 31, and there should be a curve to each measuring station.</p>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (best record company)</div>
<p>We use again the UK top 40 data set from the first week of 1964. Here we define “goodness” of a record company (<code class="docutils literal notranslate"><span class="pre">publisher</span></code>) based on the sum of the weeks of chart (WoC) of its singles. Return a DataFrame of the singles by the best record company (a subset of rows of the original DataFrame). Do this with function <code class="docutils literal notranslate"><span class="pre">best_record_company</span></code>.</p>
<hr/></div>
</div>
<div class="section" id="Time-series">
<h2>Time series<a class="headerlink" href="#Time-series" title="Permalink to this headline">¶</a></h2>
<p>Let’s make a copy of the DataFrame that we can mess with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[108]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span> <span class="o">=</span> <span class="n">wh3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">wh2</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[108]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;Year&#39;, &#39;Month&#39;, &#39;Day&#39;, &#39;Time&#39;, &#39;Time zone&#39;, &#39;Precipitation&#39;, &#39;Snow&#39;,
       &#39;Temperature&#39;, &#39;Rainy&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<p>The column names <code class="docutils literal notranslate"><span class="pre">Year</span></code>, <code class="docutils literal notranslate"><span class="pre">Month</span></code>, and <code class="docutils literal notranslate"><span class="pre">Day</span></code> are now in appropriate form for the <code class="docutils literal notranslate"><span class="pre">to_datetime</span></code> function. It can convert these fields into a timestamp series, which we will add to the DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[109]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">wh2</span><span class="p">[[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Month&quot;</span><span class="p">,</span> <span class="s2">&quot;Day&quot;</span><span class="p">]])</span>
<span class="n">wh2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[109]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>1</td>
      <td>1</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
      <td>False</td>
      <td>2017-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>1</td>
      <td>2</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
      <td>False</td>
      <td>2017-01-02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>1</td>
      <td>3</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
      <td>True</td>
      <td>2017-01-03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>1</td>
      <td>4</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
      <td>False</td>
      <td>2017-01-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017</td>
      <td>1</td>
      <td>5</td>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
      <td>2017-01-05</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can now drop the useless fields:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[110]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span><span class="o">=</span><span class="n">wh2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Month&quot;</span><span class="p">,</span> <span class="s2">&quot;Day&quot;</span><span class="p">])</span>
<span class="n">wh2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[110]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
      <td>False</td>
      <td>2017-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
      <td>False</td>
      <td>2017-01-02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
      <td>True</td>
      <td>2017-01-03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
      <td>False</td>
      <td>2017-01-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
      <td>2017-01-05</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The following method call will set the Date field as the index of the DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[111]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span> <span class="o">=</span> <span class="n">wh2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">wh2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[111]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>4.4</td>
      <td>-1.0</td>
      <td>-3.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>6.6</td>
      <td>7.0</td>
      <td>-6.5</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>13.0</td>
      <td>-12.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>10.0</td>
      <td>-17.8</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can now easily get a set of rows using date slices:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span><span class="p">[</span><span class="s2">&quot;2017-01-15&quot;</span><span class="p">:</span><span class="s2">&quot;2017-02-03&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-15</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-2.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-16</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>8.0</td>
      <td>-4.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-17</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>8.0</td>
      <td>-3.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-18</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.9</td>
      <td>8.0</td>
      <td>1.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-19</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>5.0</td>
      <td>1.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-20</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.3</td>
      <td>5.0</td>
      <td>-0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-21</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.4</td>
      <td>5.0</td>
      <td>-1.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-22</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-23</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>6.0</td>
      <td>0.1</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-24</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>6.0</td>
      <td>-2.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-25</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.6</td>
      <td>6.0</td>
      <td>-3.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-26</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>6.0</td>
      <td>1.9</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-27</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>4.0</td>
      <td>1.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-28</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.8</td>
      <td>4.0</td>
      <td>0.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-29</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.6</td>
      <td>3.0</td>
      <td>0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-01-30</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>5.6</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2017-01-31</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>4.0</td>
      <td>0.2</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-02-01</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>1.5</td>
      <td>4.0</td>
      <td>-0.6</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-02-02</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>-0.8</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-02-03</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>6.0</td>
      <td>-0.2</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>By using the <code class="docutils literal notranslate"><span class="pre">date_range</span></code> function even more complicated sets can be formed. The following gets all the mondays of July:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">r</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2017-07-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-07-31&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;w-mon&quot;</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>DatetimeIndex([&#39;2017-07-03&#39;, &#39;2017-07-10&#39;, &#39;2017-07-17&#39;, &#39;2017-07-24&#39;,
               &#39;2017-07-31&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;W-MON&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>DatetimeIndex([&#39;2017-01-01&#39;, &#39;2017-01-02&#39;, &#39;2017-01-03&#39;, &#39;2017-01-04&#39;,
               &#39;2017-01-05&#39;, &#39;2017-01-06&#39;, &#39;2017-01-07&#39;, &#39;2017-01-08&#39;,
               &#39;2017-01-09&#39;, &#39;2017-01-10&#39;,
               ...
               &#39;2017-12-22&#39;, &#39;2017-12-23&#39;, &#39;2017-12-24&#39;, &#39;2017-12-25&#39;,
               &#39;2017-12-26&#39;, &#39;2017-12-27&#39;, &#39;2017-12-28&#39;, &#39;2017-12-29&#39;,
               &#39;2017-12-30&#39;, &#39;2017-12-31&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=360, freq=None)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[99]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wh2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[99]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Time zone</th>
      <th>Precipitation</th>
      <th>Snow</th>
      <th>Temperature</th>
      <th>Rainy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-07-03</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.2</td>
      <td>-1.0</td>
      <td>14.5</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-07-10</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>18.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-07-17</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>2.7</td>
      <td>-1.0</td>
      <td>15.4</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-07-24</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>-1.0</td>
      <td>-1.0</td>
      <td>15.7</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2017-07-31</th>
      <td>00:00</td>
      <td>UTC</td>
      <td>0.1</td>
      <td>-1.0</td>
      <td>17.8</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The following finds all the business days (Monday to Friday) of July:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2017-07-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-07-31&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[100]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>DatetimeIndex([&#39;2017-07-03&#39;, &#39;2017-07-04&#39;, &#39;2017-07-05&#39;, &#39;2017-07-06&#39;,
               &#39;2017-07-07&#39;, &#39;2017-07-10&#39;, &#39;2017-07-11&#39;, &#39;2017-07-12&#39;,
               &#39;2017-07-13&#39;, &#39;2017-07-14&#39;, &#39;2017-07-17&#39;, &#39;2017-07-18&#39;,
               &#39;2017-07-19&#39;, &#39;2017-07-20&#39;, &#39;2017-07-21&#39;, &#39;2017-07-24&#39;,
               &#39;2017-07-25&#39;, &#39;2017-07-26&#39;, &#39;2017-07-27&#39;, &#39;2017-07-28&#39;,
               &#39;2017-07-31&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;B&#39;)
</pre></div>
</div>
</div>
<p>We can get a general idea about the Temperature column by plotting it. Note how the index time series is shown nicely on the x-axis.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[101]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">wh2</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/pandas_224_0.png" src="_images/pandas_224_0.png" />
</div>
</div>
<p>The graph looks a bit messy at this level of detail. We can smooth it by taking averages over a sliding window of length 30 days:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[102]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rolling</span> <span class="o">=</span> <span class="n">wh2</span><span class="o">.</span><span class="n">Temperature</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rolling</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[102]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Rolling [window=30,center=True,axis=0]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[103]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Temperature&quot;</span> <span class="p">:</span> <span class="n">wh2</span><span class="o">.</span><span class="n">Temperature</span><span class="p">,</span> <span class="s2">&quot;Rolling mean&quot;</span> <span class="p">:</span> <span class="n">rolling</span><span class="o">.</span><span class="n">mean</span><span class="p">()})</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/pandas_227_0.png" src="_images/pandas_227_0.png" />
</div>
</div>
<hr class="docutils" />
<div class="admonition note">
Exercise X (bicycle timeseries)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">bicycle_timeseries</span></code> that</p>
<ul class="simple">
<li>reads the data set</li>
<li>cleans it</li>
<li>turns its <code class="docutils literal notranslate"><span class="pre">Päivämäärä</span></code> column into (row) DatetimeIndex</li>
<li>returns the new DataFrame</li>
</ul>
<hr/><hr class="docutils" />
<div class="admonition note">
Exercise X (commute)</div>
<p>Write function <code class="docutils literal notranslate"><span class="pre">commute</span></code> that does the following:</p>
<p>Use the function <code class="docutils literal notranslate"><span class="pre">bicycle_timeseries</span></code> to get the bicycle data. Restrict to August 2017, group by the weekday, and plot the result.</p>
<hr/></div>
<div class="section" id="External-information">
<h2>External information<a class="headerlink" href="#External-information" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/pandas-dev/pandas/blob/master/doc/cheatsheet/Pandas_Cheat_Sheet.pdf">Pandas cheat sheet</a></p>
<!--NAVIGATION--></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="linear_regression.html" class="btn btn-neutral float-right" title="Linear regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="image_processing.html" class="btn btn-neutral" title="Image processing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Jarkko Toivonen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>