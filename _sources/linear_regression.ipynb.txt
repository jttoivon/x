{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Linear regression\n",
    "Regression analysis tries to explain relationships between variables. One of these variables, called dependend variable, is what we want to \"explain\" using one or more *explanatory variables*. In linear regression we assume that the dependent variable can be, approximately, expressed as a linear combination of the explanatory variables. As a simple example, we might have dependent variable height and an explanatory variable age. The age of a person can quite well explain the height of a person, and this relationship is approximately linear for kids (ages between 1 and 16). Another way of thinking about regression is fitting a curve to the observed data points. If we have only one explanatory variable, then this is easy to visualize, as we shall see below.\n",
    "\n",
    "We can apply the linear regression easily with scikit-learn package. Let's go through some examples."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "First make the usual standard imports."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import sklearn   # This imports the scikit-learn library"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Then we create some data with approximately the relationship $y=2x+1$, with normally distributed errors."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 0.          0.52631579  1.05263158  1.57894737  2.10526316  2.63157895\n",
      "  3.15789474  3.68421053  4.21052632  4.73684211  5.26315789  5.78947368\n",
      "  6.31578947  6.84210526  7.36842105  7.89473684  8.42105263  8.94736842\n",
      "  9.47368421 10.        ]\n",
      "[ 2.76405235  2.45278879  4.08400114  6.39878794  7.07808431  5.28588001\n",
      "  8.26587789  8.21706384  9.31783378 10.88428271 11.67035936 14.03322088\n",
      " 14.39261667 14.80588554 16.18070534 17.12314801 19.33618434 18.68957858\n",
      " 20.26043612 20.14590426]\n"
     ]
    }
   ],
   "source": [
    "np.random.seed(0)\n",
    "n=20   # Number of data points\n",
    "x=np.linspace(0, 10, n)\n",
    "y=x*2 + 1 + 1*np.random.randn(n) # Standard deviation 1\n",
    "print(x)\n",
    "print(y)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Next we import the LinearRegression class."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LinearRegression"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we can fit a line through the data points (x, y):"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(x,y, 'o')\n",
    "model=LinearRegression(fit_intercept=True)\n",
    "model.fit(x[:,np.newaxis], y)\n",
    "xfit=np.linspace(0,10,100)\n",
    "yfit=model.predict(xfit[:, np.newaxis])\n",
    "plt.plot(xfit,yfit)\n",
    "# The following will draw as many line segments as there are columns in matrices x and y\n",
    "plt.plot(np.vstack([x,x]), np.vstack([y, model.predict(x[:, np.newaxis])]), color=\"red\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The linear regression tries to minimize the sum of squared errors $\\sum_i (y[i] - \\hat{y}[i])^2$; this is the sum of the lengths of the red line segments in the above plot. The estimated values $\\hat{y}[i]$ are denoted by `yfit[i]` in the above code."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Parameters: [1.88627741] 2.1379475205341283\n",
      "Coefficient: 1.8862774144823018\n",
      "Intercept: 2.1379475205341283\n"
     ]
    }
   ],
   "source": [
    "print(\"Parameters:\", model.coef_, model.intercept_)\n",
    "print(\"Coefficient:\", model.coef_[0])\n",
    "print(\"Intercept:\", model.intercept_)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In this case, the coefficient is the slope of the fitted line, and the intercept is the point where the fitted line intersects with the y-axis.\n",
    "\n",
    "<div class=\"alert alert-warning\">\n",
    "Note that in scikit-learn the attributes of the model that store the learned parameters have always an underscore at the end of the name. This applies to all algorithms in sklearn, not only the linear regression. This naming style allows one to easily spot the learned model parameters from other attributes.\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The parameters estimated by the regression algorithm were quite close to the parameters that generated the data: coefficient 2 and intercept 1. Try experimenting with the number of data points and/or the standard deviation, to see if you can improve the estimated parameters."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Multiple features"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The previous example had only one explanatory variable. Sometimes this is called a *simple linear regression*. The next example illustrates a more complex regression with multiple explanatory variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "sample1=np.array([1,2,3])   # The three explanatory variables have values 1, 2, and 3, respectively\n",
    "sample2=np.array([4,5,6])   # Another example of values of explanatory variables\n",
    "sample3=np.array([7,8,10])   # ...\n",
    "y=np.array([15,39,66]) + np.random.randn(3)   # For values 1,2, and 3 of explanatory variables, the value y=4 was observed, and so on."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's try to fit a linear model to these points:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array([2.69086355, 5.05986049, 0.57960308]), 0.0)"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model2=LinearRegression(fit_intercept=False)\n",
    "x=np.vstack([sample1,sample2,sample3])\n",
    "model2.fit(x, y)\n",
    "model2.coef_, model2.intercept_"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's print the various components involved."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "x:\n",
      " [[ 1  2  3]\n",
      " [ 4  5  6]\n",
      " [ 7  8 10]]\n",
      "b:\n",
      " [[2.29372754]\n",
      " [2.46118141]\n",
      " [3.12753813]]\n",
      "y:\n",
      " [16.59870476 40.24604601 67.0209254 ]\n",
      "product:\n",
      " [[16.59870476]\n",
      " [40.24604601]\n",
      " [67.0209254 ]]\n"
     ]
    }
   ],
   "source": [
    "b=model2.coef_[:, np.newaxis]\n",
    "print(\"x:\\n\", x)\n",
    "print(\"b:\\n\", b)\n",
    "print(\"y:\\n\", y)\n",
    "print(\"product:\\n\", np.matmul(x, b))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Polynomial regression\n",
    "It may perhaps come as a surprise that one can fit a polynomial curve to data points\n",
    "using linear regression. The trick is to add new explanatory variables to the model.\n",
    "Below we have a single feature x with associated y values given by third degree polynomial,\n",
    "with some (gaussian) noise added. It is clearn from the plot that we cannot explain the data well with a linear function. We add two new features: $x^2$ and $x^3$. Now the model has three explanatory variables, $x, x^2$ and $x^3$. The linear regression will find the coefficients for these variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Coefficients: [-19.23135699 -19.10028669   0.14609221]\n",
      "Intercept: -1488.9056772937038\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "x=np.linspace(-50,150,50)\n",
    "y=0.15*x**3 - 20*x**2 + 5*x - 4 + 5000*np.random.randn(50)\n",
    "plt.scatter(x, y, color=\"black\")\n",
    "model_linear=LinearRegression(fit_intercept=True)\n",
    "model_squared=LinearRegression(fit_intercept=True)\n",
    "model_cubic=LinearRegression(fit_intercept=True)\n",
    "x2=x**2\n",
    "x3=x**3\n",
    "model_linear.fit(np.vstack([x]).T, y)\n",
    "model_squared.fit(np.vstack([x,x2]).T, y)\n",
    "model_cubic.fit(np.vstack([x,x2,x3]).T, y)\n",
    "xf=np.linspace(-50,150, 50)\n",
    "yf_linear=model_linear.predict(np.vstack([x]).T)\n",
    "yf_squared=model_squared.predict(np.vstack([x,x2]).T)\n",
    "yf_cubic=model_cubic.predict(np.vstack([x,x2,x3]).T)\n",
    "plt.plot(xf,yf_linear, label=\"linear\")\n",
    "plt.plot(xf,yf_squared, label=\"squared\")\n",
    "plt.plot(xf,yf_cubic, label=\"cubic\")\n",
    "plt.legend()\n",
    "print(\"Coefficients:\", model_cubic.coef_)\n",
    "print(\"Intercept:\", model_cubic.intercept_)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Linear and squared are not enough to explain the data, but the linear regression manages to fit quite well a polynomial curve to the data points, when cubed variables are included!"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Ridge regression"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Regression exercises"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 1 (linear regression)</div>\n",
    "Write a function `fit line` that gets one dimensional arrays `x` and `y` as parameters. The function should return the tuple `(slope, intercept)` of the fitted line. Write a main program that tests the `fit_line` function with some example arrays. The main function should produce output in the following form:\n",
    "\n",
    "Slope: 1.0<br/>\n",
    "Intercept: 1.16666666667\n",
    "\n",
    "Part 2.\n",
    "\n",
    "Modify your program to plot the fitted line using matplotlib, in addition to the textual output. Plot also the original data points.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 2 (mystery data)</div>\n",
    "Read the tab separated file mystery_data.tsv. Its first five columns define the features, and the last column is the response. Use scikit-learns's LinearRegression to fit this data. Implement function `mystery_data` that reads this file and learns and returns the regression coefficients for the five features. You don't have to fit the intercept. The main method will print output in the following form:\n",
    "\n",
    "Coefficient of X1 is ...<br/>\n",
    "Coefficient of X2 is ...<br/>\n",
    "Coefficient of X3 is ...<br/>\n",
    "Coefficient of X4 is ...<br/>\n",
    "Coefficient of X5 is ...\n",
    "\n",
    "Which features you think are needed to explain the response Y?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 3 (coefficient of determination)</div>\n",
    "Using the same data as in the previous exercise, instead of printing the regression coefficients, print the coefficient of determination. The coefficient of determination, denoted by R2, tells how well the linear regression fits the data. The maximum value of the coefficient of determination is 1. That means the best possible fit.\n",
    "\n",
    "Part 1.\n",
    "\n",
    "Using all the features (X1 to X5), fit the data using a linear regression. Get the coefficient of determination using the `score` method of the `LinearRegression` class. Write a function `coefficient_of_determination` to do all this. It should return a list containing the R2-score as the only value.\n",
    "\n",
    "Part 2.\n",
    "\n",
    "Extend your function so that it also returns R2-scores related to linear regression with each single feature in turn. The `coefficient_of_determination` (https://en.wikipedia.org/wiki/Coefficient_of_determination) function should therefore return a list with six R2-scores. To achieve this, your function should call both the fit method and the score method six times. \n",
    "\n",
    "The output from the main method should look like this:\n",
    "```\n",
    "R2-score with feature(s) X: ...\n",
    "R2-score with feature(s) X1: ...\n",
    "R2-score with feature(s) X2: ...\n",
    "R2-score with feature(s) X3: ...\n",
    "R2-score with feature(s) X4: ...\n",
    "R2-score with feature(s) X5: ...\n",
    "```\n",
    "How small can the R2-score be? Experiment both with fitting the intercept and without fitting the intercept."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 4 ()</div>"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
