{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Naive Bayes classification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Classification* is one form of supervised learning. The aim is to annotate all data points with a label. Those points that have the same label belong to the same class. There can be two or more labels. For example, a lifeforms can be classified (coarsely) with labels animal, plant, fungi, archaea, bacteria, protozoa, and chromista. The data points are observed to have certain features that can be used to predict their labels. For example, if it is has feathers, then it is most likely an animal.\n",
    "\n",
    "In supervised learning an algorithm is first given a training set of data points with their features and labels. Then the algorithm learns from these features and labels a (probabilistic) model, which can afterwards be used to predict the labels of previously unseen data.\n",
    "\n",
    "*Naive Bayes classification* is a fast and simple to understand method. Its speed is due to some simplifications we make about the underlying probability distributions, namely, the assumption about the independence of features. Yet, it can be quite powerful, especially when there are enough features in the data.\n",
    "\n",
    "Suppose we have for each label L a probability distribution. This distribution gives probability for each possible combination of features (a feature vector):\n",
    "$$P(features | L).$$\n",
    "The main idea in Bayesian classification is to reverse the direction of dependence: we want to predict the label based on the features:\n",
    "$$P(L | features)$$\n",
    "This is possible by [the Bayes theorem](https://en.wikipedia.org/wiki/Bayes%27_theorem):\n",
    "$$P(L | features) = \\frac{P(features | L)P(L)}{P(features)}.$$\n",
    "\n",
    "Let's assume we have to labels L1 and L2, and their associated distributions: $P(features | L1)$ and $P(features | L2)$. If we have a data point with \"features\", whose label we don't know, we can try to predict it using the ratio of posterior probabilities:\n",
    "$$\\frac{P(L1 | features)}{P(L2 | features)} = \\frac{P(features | L1)P(L1)}{P(features | L2)P(L2)}.$$\n",
    "If the ratio is greater than one, we label our data point with label L1, and if not, we give it label L2.\n",
    "The prior probabilities P(L1) and P(L2) of labels can be easily found out from the input data, as for each data point we also have its label. Same goes for the probabilities of features conditioned on the label."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We first demonstrate naive Bayes classification using Gaussian distributions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 323,
   "metadata": {},
   "outputs": [],
   "source": [
    "import seaborn as sns\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 324,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.datasets import make_blobs\n",
    "X,y = make_blobs(100, 2, centers=2, random_state=2, cluster_std=1.5)\n",
    "colors=np.array([\"red\", \"blue\"])\n",
    "plt.scatter(X[:, 0], X[:, 1], c=colors[y], s=50)\n",
    "for label, c in enumerate(colors):\n",
    "    plt.scatter([], [], c=c, label=str(label))\n",
    "plt.legend();\n",
    "#plt.colorbar();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 325,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.naive_bayes import GaussianNB\n",
    "from sklearn.naive_bayes import MultinomialNB\n",
    "model = GaussianNB()\n",
    "#model = MultinomialNB()\n",
    "model.fit(X, y);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Naive Bayes algorithm fitted two 2-dimensional Gaussian distribution to the data. The means and the variances define these distributions completely."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 326,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Means: [[-1.64939095 -9.36891451]\n",
      " [ 1.29327924 -1.24101221]]\n",
      "Standard deviations: [[2.06097005 2.47716872]\n",
      " [3.33164807 2.22401384]]\n"
     ]
    }
   ],
   "source": [
    "print(\"Means:\", model.theta_)\n",
    "print(\"Standard deviations:\", model.sigma_)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's plot these distributions. First we define a helper function to draw an ellipse that gives the standard deviation in each direction from the origo."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 327,
   "metadata": {},
   "outputs": [],
   "source": [
    "def plot_ellipse(ax, mu, sigma, color=\"k\", label=None):\n",
    "    \"\"\"\n",
    "    Based on\n",
    "    http://stackoverflow.com/questions/17952171/not-sure-how-to-fit-data-with-a-gaussian-python.\n",
    "    \"\"\"\n",
    "    from matplotlib.patches import Ellipse\n",
    "    # Compute eigenvalues and associated eigenvectors\n",
    "    vals, vecs = np.linalg.eigh(sigma)\n",
    "\n",
    "    # Compute \"tilt\" of ellipse using first eigenvector\n",
    "    x, y = vecs[:, 0]\n",
    "    theta = np.degrees(np.arctan2(y, x))\n",
    "\n",
    "    # Eigenvalues give length of ellipse along each eigenvector\n",
    "    w, h = 2 * np.sqrt(vals)\n",
    "\n",
    "    ax.tick_params(axis='both', which='major', labelsize=20)\n",
    "    ellipse = Ellipse(mu, w, h, theta, color=color, label=label)  # color=\"k\")\n",
    "    ellipse.set_clip_box(ax.bbox)\n",
    "    ellipse.set_alpha(0.2)\n",
    "    ax.add_artist(ellipse)\n",
    "    return ellipse"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 328,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure()\n",
    "plt.xlim(-5, 5)\n",
    "plt.ylim(-15, 5)\n",
    "plot_ellipse(plt.gca(), model.theta_[0], np.identity(2)*model.sigma_[0], color=\"red\")\n",
    "plot_ellipse(plt.gca(), model.theta_[1], np.identity(2)*model.sigma_[1], color=\"blue\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "*Accuracy score* gives a measure about how well we managed to predict the labels. The maximum value is 1.0."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 329,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy score is 1.0\n"
     ]
    }
   ],
   "source": [
    "y_fitted = model.predict(X)\n",
    "acc=accuracy_score(y,y_fitted)\n",
    "print(\"Accuracy score is\", acc)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The score was the best possible, which is not a surprise, since we tried to predict the data we had already seen!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 342,
   "metadata": {},
   "outputs": [],
   "source": [
    "# These densities based on samples don't look good.\n",
    "#data1=np.random.multivariate_normal(model.theta_[0], np.identity(2)*model.sigma_[0], size=1000)\n",
    "#data1 = pd.DataFrame(data1, columns=['x','y'])\n",
    "#sns.kdeplot(data1.x, data1.y)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Another example"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's generate some more data using multivariate normal distributions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 331,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "cov=np.array([[ 4.68, -4.32],\n",
    " [-4.32,  4.68]])\n",
    "mean1 = [0,0]\n",
    "mean2 = [0,4]\n",
    "n=500\n",
    "x1 = np.random.multivariate_normal(mean1, cov, n).T\n",
    "x2 = np.random.multivariate_normal(mean2, cov, n).T\n",
    "#print(type(x1), x1.shape)\n",
    "#print(x1[:5])\n",
    "X=np.vstack([x1.T,x2.T])\n",
    "#print(X[:5])\n",
    "y=np.hstack([[0]*n, [1]*n]).T\n",
    "#y=np.hstack([y1,y2])\n",
    "#plt.hist2d(X[:,0], X[:,1], bins=100, cmap='Blues');\n",
    "#plt.scatter(X[:,0], X[:,1], c=y)\n",
    "plt.scatter(X[:n,0], X[:n,1], color=\"red\", label=0)\n",
    "plt.scatter(X[n:,0], X[n:,1], color=\"blue\", label=1)\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The two clusters seem to be quite separate. Let's try naive Bayesian classification on this data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 332,
   "metadata": {},
   "outputs": [],
   "source": [
    "model = GaussianNB()\n",
    "#model = MultinomialNB()\n",
    "model.fit(X, y);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 333,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Means: [[-0.12823719  0.14571559]\n",
      " [ 0.01507932  3.9942384 ]]\n",
      "Standard deviations: [[4.52895773 4.35115634]\n",
      " [4.26576426 4.39396456]]\n"
     ]
    }
   ],
   "source": [
    "print(\"Means:\", model.theta_)\n",
    "print(\"Standard deviations:\", model.sigma_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 334,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy score is 0.839\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "y_fitted = model.predict(X)\n",
    "colors=np.array([\"red\", \"blue\"])\n",
    "plt.scatter(X[:,0], X[:,1], color=colors[y_fitted])\n",
    "plt.scatter([], [], color=\"red\", label=\"0\")\n",
    "plt.scatter([], [], color=\"blue\", label=\"1\")\n",
    "from sklearn.metrics import accuracy_score\n",
    "acc=accuracy_score(y,y_fitted)\n",
    "plt.legend()\n",
    "print(\"Accuracy score is\", acc)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Even thought the score is quite good, we can see from the plot that the algorithm didn't have good models for the data. We can plot the models the algorithm used:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 335,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZsAAAEJCAYAAABCNoqwAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvhp/UCwAAHdhJREFUeJzt3XuQXOV55/HvMzfNaEb3C0KMjCQQkmG5OEgGhAMGKhgTh+CKneBdx1xMsLPgxTbeKnbtxFCxaysV1iY23hBCDI5JWdkiVVChgMVrJGNgHSwIkgkgZCGBRgJ0HWl0mWs/+8d7WjMa5tIj9XvO6e7fp+pwps/py6Oupn/9nvO+7zF3R0REJKa6rAsQEZHqp7AREZHoFDYiIhKdwkZERKJT2IiISHQKGxERiU5hIyIi0aUWNmb2KTP7vpn9wsz2m5mb2UPjPGalmT1uZnvM7JCZrTezL5tZfVp1i4jI8WtI8bW+AZwNHAA6gGVj3dnMfh/4Z6Ab+CdgD/B7wHeBC4FPxyxWRETKx9KaQcDMLiGEzG+Ai4HVwD+6+2dHuO/U5H7TgAvdfW2yvRl4GrgA+Iy7r0qleBEROS6pHUZz99XuvtFLS7dPAXOAVcWgSZ6jm9BCAvjTCGWKiEgEee0gcGmyfnKEfc8Ah4CVZjYpvZJERORY5TVslibrN4bvcPd+YDPhfNPiNIsSEZFjk2YHgYmYlqz3jbK/uH36aE9gZjcBNwG0traeu2zZmP0RRERkiBdffHGXu88p1/PlNWzGY8l61PM/7n4fcB/A8uXLfe3ataPdVUREhjGzt8r5fHk9jFZsuUwbZf/UYfcTEZEcy2vYbEjWpw3fYWYNwCKgH3gzzaJEROTY5DVsnk7WV4yw7yJgMvC8u/ekV5KIiByrvJ6zeRj4S+AaM/v+sEGd30ru8zdZFSciUoq+vj46Ojro7u7OupRRNTc3097eTmNjY9TXSS1szOxq4Ork5rxkfYGZPZj8vcvdvwbg7vvN7E8IobPGzFYRpqu5itAt+mHCFDYiIrnV0dHBlClTWLhwIWY2/gNS5u7s3r2bjo4OFi1aFPW10mzZnANcO2zbYgbHyrwFfK24w90fMbOLga8DfwA0E6aw+SrwvRJnIhARyUx3d3dugwbAzJg1axY7d+6M/lqphY273wHcMcHHPAdcGaMeEZE05DVoitKqL68dBEREpIrktYOAiEj1+eUvobOzfM83fTqcf/64d3vyySe59dZbGRgY4MYbb+T2228vXw0lUtiIiKSlsxPmlG0GGCjhXMvAwAA333wzP/3pT2lvb2fFihVcddVVnH766eWrowQ6jCYiUsVeeOEFTj31VBYvXkxTUxPXXHMNjz76aOp1KGxERKrYtm3bWLBgwZHb7e3tbNu2LfU6FDYiIlVspFEiWfSQU9iIiFSx9vZ2tm7deuR2R0cH8+fPT70OhY2ISBVbsWIFGzduZPPmzfT29rJq1Squuuqq1OtQbzQRkbRMn15SD7IJPd84GhoauOeee/jYxz7GwMAAN9xwA2eccUb5aiiRwkZEJC0ljImJ4corr+TKK7OdjEWH0UREJDqFjYiIRKewERGR6BQ2IiISncJGRESiU9iIiEh06vosIpKSLK4wcMMNN/DYY48xd+5cXnnllfK9+AQpbEREUpLBFQa47rrruOWWW/jc5z5Xvhc+BjqMJiJSxS666CJmzpyZdRkKGxERiU9hIyIi0SlsREQkOoWNiIhEp95oIiIpyeAKA3zmM59hzZo17Nq1i/b2du68804+//nPl6+IEilsRFJUKMDAABSv1OsOZoNLfX1YS3XK4goDP/nJT9J/0REobETKqFCAgwehuxt6euDQoXD78OGwrbf3/Y8xGwwdgMmToaUlLK2t0NwMkyaFv5ua0v33iJSLwkbkOHR3hzDZtw927QqD9gYGBlsqDQ2DS1tbaLmMxR36+0M4dXWFvwcGBvc3N4dBgbNmhfCZPHn85xTJA4WNyAQdOhSOu7/1Vgia4uGvlhaYOfP4DoOZQWNjWEbS1wc7dkBHRwimujqYPz8s06eH25Iv7o7l+NioF4/pRqawESlBTw/s3h0CprMzhEtrK8ydm24dw4OoUAjhs3Vr2L5gAcybB1On6txPHjQ3N7N7925mzZqVy8Bxd3bv3k1zc3P018p12JjZFuDkUXa/5+7zUixHatDBg7BlC7z9dvjybmtLP2DGUlcH06aFv/v7Q+i8+WYIwqVLwyE3tXay097eTkdHBzvL2QWtzJqbm2lvb4/+OrkOm8Q+4O4Rth9IuxCpHd3dsGlTCJnGxvClncMfpkdpaIAZM8Lf3d3w0kshdD74QZg9O//1V6PGxkYWLVqUdRm5UAlh0+nud2RdhNSGQiG0ZN54I3x5V0LIjKS5OSzd3fCrX4WwOf300DITyUIlhI1IKrq7Yf360Kts1qwQNpWuGDpdXfDcc3D22eGcjkjaKuF/p0lm9lngA8BBYD3wjLsPjP0wkdJ1dobDTu5wwglZV1N+U6aE0HnxRViyBE49VedyJF2VEDbzgB8P27bZzK53959nUZBUl+3bYd268IXc0pJ1NfE0NobODZs2wf79oZUzWhdrkXLL+2+bB4DLCIHTCpwJ/C2wEHjCzM4e7YFmdpOZrTWztXnuCSLZ2rMHXn45jI+p5qApqqsLgbNnD7zyyuC0OSKxWVoDesrJzO4CbgMecfdPjnf/5cuX+9q1a+MXJhXl8GF49tkwCj+FYQa58957sGwZLF6cdSWSR2b2orsvL9fz5b1lM5p7k/VFmVYhFWtgILRo6utrM2gg9FB7/fUwWFUktkoNmx3JujXTKqRibd8Oe/cODoisRfX1YYqbdetCl2+RmCo1bC5I1m9mWoVUJHfYvLm2g6Zo0qQwFU9nZ9aVSLXLbdiY2RlmNnOE7ScD9yQ3H0q3KqkGXV1hGppaPXw2XHNzmOZGJKY8d33+NHC7ma0GNgNdwCnA7wLNwOPAXdmVJ5XqnXfU5XeotjZ4990ww4DeF4klz2GzGlgKfIhw2KwV6ASeJYy7+bFXYlc6yVxXl1o1QxUHd/b0KGwkntyGTTJgU4M2pex6eytzvrOY3I++SJtIueX2nI1ILA0NGsw4Ek1fIzHp4yU1p7U1tG5kkDs0NWVdhVQzhY3UnBNPDOcnJDhwIAzwnDQp60qkmilspOZMnx6+WPv6sq4kHw4dgpNHux6uSJkobKTm1NWFL9d9+7KuJHv9/WEmgZnvG9EmUl4KG6lJ7e2hm+/hw1lXkh33cKG4Zcuq40Jxkm8KG6lJkybBueeGMTf9/VlXk409e+ADH4AFC7KuRGqBwkZq1rRpcOaZ4dd9rXWF3r8/9Mr74Ac15kjSobCRmnbSSXDKKeHaLrXSwtm7NwTMhz6kw2eSHn3UpKaZhXMWU6YMXhp68uSsq4qjUICdO+GEE0KLTuNqJE0KGxFCC6etDV56KfzynzEj64rKq6cn/LtOOy205DRbgKRNHzmRxLRpsHIlzJoVDqsdPJh1RcdvYCCck+ruhhUrYMkSBY1kQy0bkSEmTQrnMhYuhFdfDaEzdSq0tGRd2cQMDIQLormHgFmwQDM6S7YUNiIjmDEjtHJ27YI33oAdO8I5jilTwiDIvDp8OEw/U1cHixaFrs2ahkbyQGEjMgozmDMnzBvW2RkuutbREVoNzc3hHM+Ih6QKhdC1bejS1wdeAGewn3WdARbSq6EBGhvCuqEB6htK7pPc3R0CplAIU/GcdVY4FKiQkTxR2IiMwyy0dGbMgKVLw4n2jg54712ncLibur4eWvr209Kzj7re7sFJ18wGg6UYHHbkP4AfHT5DXxBCU6p1MkybHrrItbRAUxO9vWE+s76+8NC2tjBeZvbs6u1JJ5VPYSNSqkKB+q79zD7Qyez+XfQV9tLVZ+w/1MCuQ5PZ0zOZgrVBfT0N9dDY4DTUOw0NTsMED70VBpz+3gJ9e3ro7+igr89xDBobaZ3bxvyFbcxcOpW2uZNpbY3zzxUpJ4WNyFjcw3D7d98NzZne3nDYq6WFxjnTmXlCHTOBhYB7D4e66zh4uI79B+s43BP+PtRdR09vHeChsQPgRvIXYGChlVNsDNUZtLYUaJtRx+QTG2htKTCltUBrYy+NfR3h2NnrDtunhhMzs2dXXi8GqSkKG5GRHDwI27fD1q1hkEpDQ+iWNsaQe0sCorWlwNxhsygXCtDXb/T1G4Ujp24MTwLGzDFCa6ixwcd4mXponhJ6KkAInX//95BQ06eH6aznztXUAJI7+kSKDNXVBVu2hFZMQ0P4Up827biftq4OJjU5k5rKPAlbc3NYIHRFW7cu1L1kSRipqv7OkhMKGxEIX9SbNoWWTFNT6IZWaTNUtrSEpb8fNmyA3/wm9GiYPz/f/bWlJihspLa5h1bMq6+GL+RKDJnhGhrCOZy+vnCIbfNmOOeccBhQJCOauEJqV18f/PrXYZk+PfRtrvSgGaqxMYQnwHPPhVCttWspSG6oZSO1qasL/u3fwgn2uXOrK2SGa20NIzzXrw+jU3VpTsmAWjZSe/btg+efD7/yZ82q7qApamgIobptG6xdWzsX75HcUNhIbenuhhdfDL/229qyriZdZuFczv798NprOqQmqVLYSO0YGICXXw5/1/IAyJkz4e234a23sq5EaojCRmrHhg3hnEUZxs1UtOIMo6++GiZ6E0lB7sPGzNrN7Idmtt3Mesxsi5ndbWZVdi1FiaqnJ/yanz0760ryob4+HEp8882sK5EakesuKWZ2CvA8MBd4FHgd+DBwK3CFmV3o7rszLFEqxY4dxXlhsq4kP1pbw/ty+HBtH1aUVOS9ZfO/CEHzX9z9ane/3d0vBb4LLAW+nWl1Uhncw8DG4nxiElhyLZ333su6EqkBuQ0bM1sMXA5sAX4wbPc3gYPAH5uZJliXsR0+HCbW1NXE3q+1NUw4KhJZbsMGuDRZP+XuhaE73L0LeA6YDJyfdmFSYfr7dfhsNA0N4XyWSGR5DpulyfqNUfZvTNanpVCLSPXSeBtJQZ7Dptg/dd8o+4vbp4+008xuMrO1ZrZ2586dZS9OKohmPB7dwIAOL0oq8hw24xlyIff3c/f73H25uy+fU5yMUGpTS0v4Qu3ry7qS/Dl4MExjIxJZnsOm2HIZbQTe1GH3ExlZXV24guU+fVTep78fTjwx6yqkBuQ5bDYk69HOySxJ1qOd0xEZNG9euDazzk8MOnQoXFah1uaIk0zkOWxWJ+vLzeyoOs1sCnAhcBj4ZdqFSQWaPDn8gtf0LIF7mJBz8eKsK5EakduwcfdNwFPAQuDmYbvvBFqBf3D3gymXJpXq9NPDuZsDB7KuJHs7d8Ipp+h8jaQm19PVAP+ZMF3N98zsMuA14DzgEsLhs69nWJtUmqYm+K3fCletbGys3V5Ye/eGiThP06gBSU9uWzZwpHWzHHiQEDK3AacA3wMu0LxoMmFtbSFwOjvDtW1qTWdnCNozzwwdJ0RSkveWDe6+Fbg+6zqkisyZA+edBy+9FAJn+ohDtapLoQC7doVZr888s3ZbdZIZ/bSR2jRrFnzkI6Gls2NH+DKuVj094RzNqafCuedCc3PWFUkNyn3LRiSalhZYvhw2bgzXdam2S0UXCrBnTzhctmJFaNGJZERhI7Wtvh6WLQvjcDZsCNPtt7WF4KlUhUIYwNrXB4sWhUWHzSRjChsRCOdtPvzh0BLYsCEcWmtpCcFTKTNG9/eHkBkYgA98ABYurOzQlKqisBEpMgvnci64IPTa2rIltHTcw6DQ1tb8BU9/P3R1hVZMU1NoxbS368qbkjsKG5HhzMI0LjNmhC/xvXth69Zwkh3CCfaWlnAtmLS5hxP+hw+H2hobYcECOOEEmDpV3ZkltxQ2ImNpbAyj7OfOhd7ecJht587Qjbg4TqeuLoRPc3P5L2fQ1xeCpacnBI1ZCJUFC0JN06YpYKQiKGxEStXUFDoSzJsXbvf0hCn6u7pg9+4QRP39Rz/GLIRBfX34u7gUJwR1Dyf0+/sHw2ToZKEtLSFUihNmtrbq+jxSkRQ2Isdq0qSwzJwZLmEA4eR8X19oBfX1Hd0yKRSOnnm6rm5wmTw5PFdj49GLWi1SJRQ2IuVUXx8WDZwUOYp+NomISHQKGxERiU5hIyIi0SlsREQkOoWNiIhEp7AREZHoFDYiIhKdwkZERKJT2IiISHQKGxERiU5hIyIi0SlsREQkOoWNiIhEp7AREZHoFDYiIhKdwkZERKJT2IiISHQKGxERiU5hIyIi0eUybMxsoZn5GMuqrGsUEZHSNWRdwDjWAY+MsP2VtAsREZFjl/ewednd78i6CBEROT65PIwmIiLVJe8tm/lm9gVgFrAb+H/uvj7jmkREZILyHja/kyxHmNka4Fp3fzuTikREZMLyehjtEPAXwLnAjGS5GFgNfBT4mZm1jvUEZnaTma01s7U7d+6MXK6IiIwlWtiY2ZZxui8PXx4qPtbdd7j7n7v7S+7emSzPAJcD/wqcCtw41uu7+33uvtzdl8+ZMyfWP1NEREoQ8zDaJqB7AvffPt4d3L3fzO4HzgMuAv76GGsTEZEURQsbd78s0lMXj4mNeRhNRETyI6/nbMZyfrJ+M9MqRESkZLkMGzM7z8yaRth+KfCV5OZDw/eLiEg+5bXr818CZyTdnDuSbWcBlyZ//5m7P59FYSIiMnF5DZsfA58EVgAfBxqB94D/Ddzj7r/IsDYREZmgXIaNu/898PdZ1yEiIuWRy3M2IiJSXRQ2IiISncJGRESiU9iIiEh0ChsREYlOYSMiItEpbEREJDqFjYiIRKewERGR6BQ2IiISncJGRESiU9iIiEh0ChsREYlOYSMiItEpbEREJDqFjYiIRKewERGR6BQ2IiISncJGRESiU9iIiEh0ChsREYlOYSMiItEpbEREJDqFjYiIRKewERGR6BQ2IiISncJGRESiU9iIiEh00cPGzBrN7FYze8DMXjazXjNzM7uxhMdea2YvmNkBM9tnZmvM7BOxaxYRkfJKo2XTCtwNXAfMA94t5UFmdhfwIHAi8HfAQ8CZwL+Y2S0xChURkTjSCJtDwJXAfHefB/xwvAeY2UrgNmATcJa7f8XdbwbOBfYAd5nZwmgVi4hIWUUPG3fvdfcn3P2dCTzsi8n62+6+d8hzbQF+AEwCri9flSIiElNeOwhcmqyfHGHfE8PuIyIiOZe7sDGzVuAk4MAoraGNyfq09KoSEZHjkbuwAaYl632j7C9unz7Wk5jZTWa21szW7ty5s2zFiYjIxJUUNma2JemuXOryUOzCAR9zp/t97r7c3ZfPmTMnhXJERGQ0DSXebxPQPYHn3X4MtRQVWy7TRtk/XstHRERypqSwcffLYhcy5LUOmtk24CQzO3GE8zZLkvUbadUkIiLHJ4/nbACeTtZXjLDv48PuIyIiOZfXsLk3WX/dzGYUNyYDOW8GeoAH0i9LRESORannbI6Lmd0OLEtunpOsrzezjyR/P+vu9xfv7+7Pm9l3gK8C683sYaAJ+CNgJvClZICniIhUgFTChnA47OJh21YmS9H9Q3e6+21mth64BbgJKAAvAX/l7o9FrFVERMoslbBx948e4+N+BPyovNWIiEja8nrORkREqojCRkREolPYiIhIdAobERGJTmEjIiLRKWxERCQ6hY2IiESnsBERkegUNiIiEp3CRkREolPYiIhIdAobERGJTmEjIiLRKWxERCQ6hY2IiESnsBERkegUNiIiEp3CRkREolPYiIhIdAobERGJTmEjIiLRKWxERCQ6hY2IiESnsBERkegUNiIiEp3CRkREolPYiIhIdAobERGJTmEjIiLRRQ8bM2s0s1vN7AEze9nMes3MzezGMR5zXXKf0ZYvxq5bRETKpyGF12gF7k7+fg94F1hQ4mMfBV4eYfvaMtQlIiIpSSNsDgFXAi+7+ztmdgfwzRIf+4i7PxirMBERSUf0sHH3XuCJ2K8jIiL5lUbL5nicY2ZfBpqBbcBqd+/IuCYREZmgvIfNrcNuD5jZ/cCX3b07i4JERGTi8ho2m4EvAU8BHcA04CPA/wC+AEwF/uNYT2BmNwE3JTd7zOyVaNXWltnArqyLqCJ6P8tL72f5LC3nk5m7j38nsy3AyRN43n9098+O8lx3EDoI/Im73z+B58TMFgDrgBnAOe6+rsTHrXX35RN5LRmZ3svy0vtZXno/y6fc72WpLZtNwEQOW20/hlrG5e5bzexx4D8BFxGCR0REcq6ksHH3y2IXMgE7k3VrplWIiEjJKnG6mvOS9ZsTeMx9MQqpUXovy0vvZ3np/Syfsr6XuQwbM/vtEbaZmf034ALCCcAnS30+d9cHsEz0XpaX3s/y0vtZPuV+L0vqIHDcL2J2O7AsuXkOcDbwPLAx2fbs0M4CZubAG8CvCONrpgEXAv+BMCPBJ939qeiFi4hIWaQVNmuAi8e4y4/c/boh9/8r4MPAEmAmUADeBv4v8B13n8ghNBERyVgqh9Hc/aPubmMs1w27/39194vdfb67N7v7ZHdf5u63lBI0xzLT9JDHXmtmL5jZATPbZ2ZrzOwTx/HPr1pmtnCc2blXZV1jHplZu5n90My2m1mPmW0xs7vNbEbWtVWa5L0b7fP3btb15ZGZfcrMvm9mvzCz/cl79dA4j1lpZo+b2R4zO2Rm683sy2ZWX+rr5nVQ5/E6ppmmzewu4DbCQNK/A5qAa4B/MbMvufs9ccqteOuAR0bYroG0w5jZKYRDyHMJs5q/TmjF3wpcYWYXuvvuDEusRPsY/P99qANpF1IhvkE4lXGA8F23bKw7m9nvA/9MGP7yT8Ae4PeA7xJOb3y6pFd196pbCCHxceDE5PYdgAM3jvGYlcl9fgPMGLJ9IbA7eaMXZv1vy9OSvDcOPJh1LZWyAP8nec++NGz7d5Lt92ZdYyUtwBZgS9Z1VNICXEI4RWHAR5PP3UOj3HcqsAPoAZYP2d5M+NHkwDWlvG4ue6MdL3fvdfcn3P2dCTyseEG2b7v73iHPtQX4ATAJuL58VUqtMbPFwOWEL8gfDNv9TeAg8MdmpjFkEo27r3b3jZ6kxjg+BcwBVrn7keuIeZib8hvJzT8t5XWrMmyO0aXJeqQu1U8Mu48cbb6ZfcHM/nuyPivrgnKq+Pl5yt0LQ3e4exfwHDAZOD/twircJDP7bPL5u9XMLpnIuQQZ01jfi88QegevNLNJ4z1RtZ6zmZDkl+RJwIFRWkPFLtqnpVdVRfmdZDki6YF4rbu/nUlF+VSc2PCNUfZvJLR8TgN+lkpF1WEe8ONh2zab2fXu/vMsCqoio35m3b3fzDYDZwCLgdfGeiK1bIJpyXrfKPuL26enUEslOQT8BXAuYXLUGYQu7qsJx4J/pkNCR9HnrPweAC4jBE4rcCbwt4TziU+Y2dnZlVYVyvaZzW3YjNOlcaRlzK57ZRJ/UFLKjud9dvcd7v7n7v6Su3cmyzOEX+f/CpwKjNvdXI6wZF11n7NY3P1Od3/a3d9z90Pu/oq7f5HQ4aKF0DlI4in5M5vnw2hpzjRdTOdpo+wfL90rWdnf56R5fT9hHruLgL8+xtqqzXifs6nD7ifH7l7CMIaLsi6kwpXtM5vbsPEUZ5p294Nmtg04ycxOHOG8zZJkPdqx9ooV8X3W7NzvtyFZj3bur2o/ZxnYkaz1+Ts+G4DlhM/si0N3mFkDsAjop4SJkXN7GC0DTyfrK0bY9/Fh95HxFXtUaWqhQauT9eVmdtT/e2Y2hTBA7jDwy7QLq0IXJGt9/o7PWN+LFxF6Tz7v7j3jPZHCZtC9yfrrQ6cNMbOFwM2EQU0PpF9WfpnZeWbWNML2S4GvJDfTOJdWEdx9E+FS5wsJn6mh7iT8Cv8Hdz+YcmkVyczOMLOZI2w/GSjO9qHP3/F5mDDL/jVmduSqnWbWDHwrufk3pTxRKhNxZmGiM00nj/mfwFcJUzg8TJiJ4I+AWYQR35quZoike/MZwBrCewZwFoN98//M3b/1/kfWrhGmq3mNcG7rEsLhs5Wu6WpKYuES87cTWoybgS7gFOB3CSPcHyfMEN+bVY15ZGZXA1cnN+cBHyO0AH+RbNvl7l8bdv+HCed2VxGmq7mK0C36YeAPSxogmvXUCRGnZFhD6CEx2vLgKI+7lnBpg4OED+/PgU9k/e/J4wJ8HniMMCL+AKH19zZh/qTfzrq+vC6EefoeAN4BeoG3CJ0oZmZdWyUthG72PyHML9cJ9BHOFf4U+BzJj2kt73vf7hjnu3HLCI+5kBDeewmHen9NOHpRX+rrVm3LRkRE8kPnbEREJDqFjYiIRKewERGR6BQ2IiISncJGRESiU9iIiEh0ChsREYlOYSMiItEpbEREJDqFjYiIRPf/ATP6+MJnRvHtAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.figure()\n",
    "plt.xlim(-10, 10)\n",
    "plt.ylim(-15, 10)\n",
    "e1=plot_ellipse(plt.gca(), model.theta_[0], np.identity(2)*model.sigma_[0], color=\"red\", label=\"0\")\n",
    "e2=plot_ellipse(plt.gca(), model.theta_[1], np.identity(2)*model.sigma_[1], color=\"blue\", label=\"1\")\n",
    "plt.legend([e1, e2], [\"0\", \"1\"]);"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The problem with naive Bayesian classification is that it tries to model the data using Gaussian distributions, which are aligned along the x and y axes. With this example data we would have needed Gaussian distributions which are \"tilted\"."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Text classification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We next try to classificate a set of messages that were posted on a public forum. The messages were divided into groups by the topics. So, we have a data set ready for classification testing. Let's first load this data using scikit-learn and print the message categories."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 336,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['alt.atheism',\n",
       " 'comp.graphics',\n",
       " 'comp.os.ms-windows.misc',\n",
       " 'comp.sys.ibm.pc.hardware',\n",
       " 'comp.sys.mac.hardware',\n",
       " 'comp.windows.x',\n",
       " 'misc.forsale',\n",
       " 'rec.autos',\n",
       " 'rec.motorcycles',\n",
       " 'rec.sport.baseball',\n",
       " 'rec.sport.hockey',\n",
       " 'sci.crypt',\n",
       " 'sci.electronics',\n",
       " 'sci.med',\n",
       " 'sci.space',\n",
       " 'soc.religion.christian',\n",
       " 'talk.politics.guns',\n",
       " 'talk.politics.mideast',\n",
       " 'talk.politics.misc',\n",
       " 'talk.religion.misc']"
      ]
     },
     "execution_count": 336,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.datasets import fetch_20newsgroups\n",
    "data = fetch_20newsgroups()\n",
    "data.target_names"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We concentrate on four message categories only. The tool fetch_20newsgroups allows us to easily split the data into training and testing data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 337,
   "metadata": {},
   "outputs": [],
   "source": [
    "categories = ['comp.graphics', 'rec.autos', 'sci.electronics', 'sci.crypt']\n",
    "train = fetch_20newsgroups(subset='train', categories=categories)\n",
    "test = fetch_20newsgroups(subset='test', categories=categories)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's see what we got:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 338,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training data: Data: <class 'list'> 2364 Target: <class 'numpy.ndarray'> 2364\n",
      "Test data: Data: <class 'list'> 1574 Target <class 'list'> 1574\n"
     ]
    }
   ],
   "source": [
    "print(\"Training data:\", \"Data:\", str(type(train.data)), len(train.data), \"Target:\", str(type(train.target)), len(train.target))\n",
    "print(\"Test data:\", \"Data:\", str(type(test.data)), len(test.data), \"Target\", str(type(test.data)), len(test.target))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We use as features the frequencies of each word in the dataset. That is, there as many features as there are distinct words in the dataset. We denote the number of features by $f$. As the features are now counts, it is sensible to use multinomial distribution instead of Gaussian. \n",
    "\n",
    "Let's try to model these messages using multinomial distributions. Each message category has its own distribution. A multinomial distribution has $f$ non-negative parameters $\\theta_1,\\ldots , \\theta_f$, which sum up to one. For example, the parameter $\\theta_3$ might tell the the probability of the word \"board\" appearing in a message of the category this distribution is describing.\n",
    "\n",
    "In scikit-learn there is a class CountVectorizer that converts messages in form of text strings to feature vectors. We can integrate this conversion with the model we are using (multinomial naive Bayes), so that the conversion happens automatically as part of the fit method. We achive this integration using the make_pipeline tool."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 339,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy score is 0.920584498094028\n"
     ]
    }
   ],
   "source": [
    "#from sklearn.feature_extraction.text import TfidfVectorizer  # an alternative feature extractor\n",
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "from sklearn.naive_bayes import MultinomialNB\n",
    "from sklearn.pipeline import make_pipeline\n",
    "\n",
    "#model = make_pipeline(TfidfVectorizer(), MultinomialNB())\n",
    "model = make_pipeline(CountVectorizer(), MultinomialNB())\n",
    "model.fit(train.data, train.target)\n",
    "labels_fitted = model.predict(test.data)\n",
    "print(\"Accuracy score is\", accuracy_score(labels_fitted, test.target))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The classifier seem to work quite well! \n",
    "\n",
    "Let's have a closer look at the resulting feature vectors."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 340,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Type of feature matrix: <class 'scipy.sparse.csr.csr_matrix'>\n",
      "  (0, 20579)\t1\n",
      "  (0, 19220)\t1\n",
      "  (0, 29697)\t1\n",
      "  (0, 6320)\t1\n",
      "  (0, 25926)\t1\n",
      "  (0, 34222)\t1\n",
      "  (0, 31398)\t1\n",
      "  (0, 17883)\t1\n",
      "  (0, 16809)\t1\n",
      "  (0, 34425)\t1\n",
      "  (0, 23460)\t1\n",
      "  (0, 21787)\t1\n",
      "  (0, 11068)\t1\n",
      "  (0, 29494)\t1\n",
      "  (0, 29505)\t1\n",
      "  (0, 18436)\t1\n",
      "  (0, 24025)\t1\n",
      "  (0, 25336)\t1\n",
      "  (0, 12577)\t1\n",
      "  (0, 27517)\t1\n",
      "  (0, 30641)\t1\n",
      "  (0, 5980)\t1\n",
      "  (0, 29104)\t1\n",
      "  (0, 27521)\t1\n",
      "  (0, 11100)\t1\n",
      "  :\t:\n",
      "  (0, 17310)\t1\n",
      "  (0, 25400)\t1\n",
      "  (0, 23118)\t1\n",
      "  (0, 31686)\t6\n",
      "  (0, 27158)\t1\n",
      "  (0, 18085)\t1\n",
      "  (0, 12580)\t1\n",
      "  (0, 2100)\t1\n",
      "  (0, 20381)\t1\n",
      "  (0, 32729)\t1\n",
      "  (0, 23854)\t2\n",
      "  (0, 11079)\t1\n",
      "  (0, 15109)\t2\n",
      "  (0, 20509)\t1\n",
      "  (0, 23858)\t1\n",
      "  (0, 26624)\t1\n",
      "  (0, 30377)\t1\n",
      "  (0, 16034)\t1\n",
      "  (0, 19099)\t1\n",
      "  (0, 13317)\t6\n",
      "  (0, 34790)\t6\n",
      "  (0, 9553)\t4\n",
      "  (0, 21852)\t5\n",
      "  (0, 18962)\t3\n",
      "  (0, 15373)\t1\n"
     ]
    }
   ],
   "source": [
    "vec=CountVectorizer()\n",
    "features=vec.fit_transform(train.data)\n",
    "print(\"Type of feature matrix:\", type(features))\n",
    "print(features[0,:])        # print the features of the first sample point"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The feature matrix is stored in sparse format, that is, only the nonzero counts are stored. How many words were in the first message?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 341,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of words: 177\n",
      "Word 'it' appears in the first message 2 times.\n",
      "\n",
      "From: jgfoot@minerva.cis.yale.edu (Josh A. Goldfoot)\n",
      "Subject: Re: Organized Lobbying for Cryptography\n",
      "Organization: Yale University\n",
      "Lines: 21\n",
      "Distribution: inet\n",
      "Reply-To: jgfoot@minerva.cis.yale.edu\n",
      "NNTP-Posting-Host: minerva.cis.yale.edu\n",
      "X-Newsreader: TIN [version 1.1 Minerva PL9]\n",
      "\n",
      "Shaun P. Hughes (sphughes@sfsuvax1.sfsu.edu) wrote:\n",
      ": In article <1r3jgbINN35i@eli.CS.YALE.EDU> jgfoot@minerva.cis.yale.edu writes:\n",
      "[deletion]\n",
      ": >Perhaps these encryption-only types would defend the digitized porn if it\n",
      ": >was posted encrypted?\n",
      ": >\n",
      ": >These issues are not as seperable as you maintain.\n",
      ": >\n",
      "\n",
      ": Now why would anyone \"post\" anything encrypted? Encryption is only of \n",
      ": use between persons who know how to decrypt the data.\n",
      "\n",
      ": And why should I care what other people look at? \n",
      "\n",
      "I was responding to another person (Tarl Neustaedter) who held that the\n",
      "EFF wasn't the best organization to fight for crytography rights since the\n",
      "EFF also supports the right to distribute pornography over the internet,\n",
      "something some Crypto people might object to. In other words, he's\n",
      "implying that there are people who will protect any speech, just  as long\n",
      "as it is encrypted.\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\"Number of words:\", features[0,:].sum())\n",
    "col = vec.vocabulary_[\"it\"]   # Get the column of 'it' word in the feature matrix\n",
    "print(\"Word 'it' appears in the first message %i times.\" % features[0, col])\n",
    "print()\n",
    "print(train.data[0])   # Let's print the corresponding message as well\n",
    "#print(vec.get_feature_names())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 5 (blob_classification)</div>\n",
    "\n",
    "Write a function blob_classification that gets feature matrix X and label vector y as parameters. It should then return the accuracy score of the prediction. Do the prediction using GaussianNB, and use train_test_split function from sklearn to split the dataset in to two equal halves: one for training and one for testing. Give parameter random_state=0 to the splitting function so that the result is deterministic. Use training set size of 75% of the whole data."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 6 (plant classification)</div>\n",
    "\n",
    "Write function plant_classification that does the following:\n",
    "* loads the iris dataset using sklearn (sklearn.datasets.load_iris)\n",
    "* splits the data into training and testing part using the train_test_split function so that the training set size is 80% of the whole data (give the call also the random_state=0 argument to make the result deterministic)\n",
    "* use Gaussian naive Bayes to fit the training data\n",
    "* predict labels of the test data\n",
    "* the function should return the accuracy score of the prediction performance (sklearn.metrics.accuracy_score)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 7 (word classification)</div>\n",
    "\n",
    "Part 1.\n",
    "\n",
    "Write function get_features that gets a one dimensional np.array, containing words, as parameter. It should return a feature matrix of shape (n, 29), where n is the number of elements of the input array. There should be one feature for each of the letters in the following alphabet: \"abcdefghijklmnopqrstuvwxyzäö-\".\n",
    "\n",
    "Part 2.\n",
    "\n",
    "Write function contains_valid_chars that takes a string as a parameter and returns the truth value of whether all the characters in the string belong to the alphabet or not.\n",
    "\n",
    "Part 3.\n",
    "\n",
    "Write function get_features_and_labels() that returns the tuple (X, y) of the feature matrix and the target vector. Use the labels 0 and 1 for Finnish and English, respectively. Use the supplied functions load_finnish() and load_english() to get the lists of words. Filter the lists in the following ways:\n",
    "\n",
    "* Convert the Finnish words to lowercase, and then filter out those words that contain characters that don't belong to the alphabet.\n",
    "* For the English words first filter out those words that begin with an uppercase letter to get rid of proper nouns. Then proceed as with the Finnish words.\n",
    "\n",
    "Use get_features function you made earlier to form the feature matrix.\n",
    "\n",
    "Part 4.\n",
    "\n",
    "Create `word_classification` function that does the following:\n",
    "\n",
    "Use the function `get_features_and_labels` you made earlier to get the feature matrix and the labels. Use multinomial naive Bayes to do the classification. Get the accuracy scores using the `sklearn.model_selection.cross_val_score` function; use 5-fold cross validation. The function should return a list of five accuracy scores.\n",
    "\n",
    "The cv parameter of cross_val_score can be either an integer, which specifies the number of folds, or it can be a *cross-validation generator* that generates the (train set,test set) pairs. What happens if you pass the following cross-validation generator to `cross_val_score` as a parameter: `sklearn.model_selection.KFold(n_splits=5, shuffle=True, random_state=0)`.\n",
    "\n",
    "Why the difference?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### <div class=\"alert alert-info\">Exercise 8 (spam detection)</div>\n",
    "\n",
    "In the src folder there are two files: ham.txt.gz and spam.txt.gz. The files are preprocessed versions of the files from https://spamassassin.apache.org/old/publiccorpus/. There is one email per line. The file ham.txt.gz contains emails that are non-spam, and, conversely, emails in file spam.txt are spam. The email headers have been removed, except for the subject line, and non-ascii characters have been deleted.\n",
    "\n",
    "Write function spam_detection that does the following:\n",
    "* reads these files. Use function open from gzip module, since the files are compressed.\n",
    "* forms the combined feature matrix using `CountVectorizer` class' `fit_transform` method.\n",
    "* use labels 0 for ham and 1 for spam\n",
    "* divide that feature matrix and the target label into training and test sets, using `train_test_split`\n",
    "* train a MultinomialNB model, and use it to predict the labels for the test set\n",
    "\n",
    "The function should return a triple consisting of\n",
    "* accuracy score of the prediction\n",
    "* size of test sample\n",
    "* number of misclassified sample points\n",
    "\n",
    "Pass the function's random_state parameter to function `train_test_split`."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
